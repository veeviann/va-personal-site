<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Vivian Chew">
<meta name="dcterms.date" content="2025-02-01">

<title>Exercise 01 - Heart Attack In Japan – VVA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-1cc56b66eba605203cf9616d8c55c428.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">VVA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercises" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercises">    
        <li>
    <a class="dropdown-item" href="../hands-on/week01.html">
 <span class="dropdown-text">Week 01</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../hands-on/week02.html">
 <span class="dropdown-text">Week 02</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../hands-on/week03.html">
 <span class="dropdown-text">Week 03</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../hands-on/week04.html">
 <span class="dropdown-text">Week 04</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../hands-on/week05.html">
 <span class="dropdown-text">Week 05</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../hands-on/week07.html">
 <span class="dropdown-text">Week 07</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../hands-on/week09.html">
 <span class="dropdown-text">Week 08</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../hands-on/week10.html">
 <span class="dropdown-text">Week 09</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercises" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercises">    
        <li>
    <a class="dropdown-item" href="../take-home/exercise01.html">
 <span class="dropdown-text">Exercise 01</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../take-home/exercise02.html">
 <span class="dropdown-text">Exercise 02</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercises" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercises">    
        <li>
    <a class="dropdown-item" href="../in-class/exercise04.html">
 <span class="dropdown-text">Exercise 04</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../in-class/exercise05.html">
 <span class="dropdown-text">Exercise 05</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../in-class/exercise07.html">
 <span class="dropdown-text">Exercise 07</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../in-class/exercise08.qmd">
 <span class="dropdown-text">Exercise 08</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> <i class="bi bi-house-fill" role="img">
</i> 
<span class="menu-text"> </span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> <i class="bi bi-house-fill" role="img">
</i> 
<span class="menu-text"> </span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">1 Overview</a>
  <ul class="collapse">
  <li><a href="#background" id="toc-background" class="nav-link" data-scroll-target="#background">1.1 Background</a></li>
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">1.2 Objectives</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">1.3 References</a></li>
  </ul></li>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">2 Getting Started</a>
  <ul class="collapse">
  <li><a href="#relevant-libraries" id="toc-relevant-libraries" class="nav-link" data-scroll-target="#relevant-libraries">2.1 Relevant Libraries</a></li>
  <li><a href="#data-source" id="toc-data-source" class="nav-link" data-scroll-target="#data-source">2.2 Data Source</a>
  <ul class="collapse">
  <li><a href="#about-the-data-source" id="toc-about-the-data-source" class="nav-link" data-scroll-target="#about-the-data-source">2.2.1 About the Data Source</a></li>
  <li><a href="#considerations-and-limitations" id="toc-considerations-and-limitations" class="nav-link" data-scroll-target="#considerations-and-limitations">2.2.2 Considerations and Limitations</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">3. Data Wrangling</a>
  <ul class="collapse">
  <li><a href="#should-we-remove-the-unknown-columns" id="toc-should-we-remove-the-unknown-columns" class="nav-link" data-scroll-target="#should-we-remove-the-unknown-columns">3.1 Should we remove the unknown columns?</a></li>
  <li><a href="#summary-of-initial-data-checks" id="toc-summary-of-initial-data-checks" class="nav-link" data-scroll-target="#summary-of-initial-data-checks">3.2 Summary of Initial Data Checks</a></li>
  <li><a href="#binning-numerical-variables" id="toc-binning-numerical-variables" class="nav-link" data-scroll-target="#binning-numerical-variables">3.3 Binning Numerical Variables</a></li>
  <li><a href="#final-description-of-the-features" id="toc-final-description-of-the-features" class="nav-link" data-scroll-target="#final-description-of-the-features">3.4 Final Description of the Features</a></li>
  <li><a href="#references-1" id="toc-references-1" class="nav-link" data-scroll-target="#references-1">3.5 References</a></li>
  </ul></li>
  <li><a href="#data-analysis" id="toc-data-analysis" class="nav-link" data-scroll-target="#data-analysis">4. Data Analysis</a>
  <ul class="collapse">
  <li><a href="#how-do-age-and-gender-shape-heart-attack-risk" id="toc-how-do-age-and-gender-shape-heart-attack-risk" class="nav-link" data-scroll-target="#how-do-age-and-gender-shape-heart-attack-risk">4.1 How Do Age and Gender Shape Heart Attack Risk?</a></li>
  <li><a href="#does-your-medical-history-decide-your-heart-attack-risk" id="toc-does-your-medical-history-decide-your-heart-attack-risk" class="nav-link" data-scroll-target="#does-your-medical-history-decide-your-heart-attack-risk">4.2 Does Your Medical History Decide Your Heart Attack Risk?</a></li>
  <li><a href="#how-do-uncontrollable-factors-interact-in-determining-your-heart-attack-risk" id="toc-how-do-uncontrollable-factors-interact-in-determining-your-heart-attack-risk" class="nav-link" data-scroll-target="#how-do-uncontrollable-factors-interact-in-determining-your-heart-attack-risk">4.3 How Do Uncontrollable Factors Interact in Determining Your Heart Attack Risk?</a></li>
  <li><a href="#does-your-behavioural-and-lifestyle-factors-influence-your-medical-indicators" id="toc-does-your-behavioural-and-lifestyle-factors-influence-your-medical-indicators" class="nav-link" data-scroll-target="#does-your-behavioural-and-lifestyle-factors-influence-your-medical-indicators">4.4 Does Your Behavioural and Lifestyle Factors Influence Your Medical Indicators?</a></li>
  <li><a href="#how-do-uncontrollable-factors-interact-in-determining-your-heart-attack-risk-1" id="toc-how-do-uncontrollable-factors-interact-in-determining-your-heart-attack-risk-1" class="nav-link" data-scroll-target="#how-do-uncontrollable-factors-interact-in-determining-your-heart-attack-risk-1">4.5 How Do Uncontrollable Factors Interact in Determining Your Heart Attack Risk?</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">4.6 Conclusion</a></li>
  <li><a href="#references-2" id="toc-references-2" class="nav-link" data-scroll-target="#references-2">4.7 References</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Exercise 01 - Heart Attack In Japan</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Vivian Chew </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 1, 2025</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">February 25, 2025</p>
    </div>
  </div>
    
  </div>
  


</header>


<p>Disclaimer: The content has been parsed through various LLMs for refinement.</p>
<section id="overview" class="level1">
<h1>1 Overview</h1>
<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">1.1 Background</h2>
<p>Cardiovascular diseases (CVDs) remain a major health concern in Japan, ranking as the second and fourth leading causes of death, according to recent statistics [1]. While overall CVD mortality has declined, challenges continue to exist in certain demographics and regions. In particular, the incidence of ischemic heart disease is projected to rise among urban male employees and middle-aged men [2]. Although projections suggest a potential decline in CVD-related deaths across most Japanese prefectures between 2020 and 2040 [3], this trend is not uniform. The evolving landscape of risk factors necessitates ongoing vigilance and targeted interventions.</p>
</section>
<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">1.2 Objectives</h2>
<p>We will first examine risk factors beyond individual control before focusing on modifiable factors. The outcome variable (O) will be Heart Attack Occurrence. The goal is to provide recommendations for reducing heart attack risk by emphasizing controllable factors while recognizing the influence of non-modifiable ones.</p>
<p><strong>Factors Beyond Individual Control (U)</strong></p>
<ul>
<li><p>Demographics &amp; Medical History</p></li>
<li><p>Key analyses:</p>
<ol type="1">
<li>Examining age and sex distribution among heart attack patients.</li>
<li>Investigating how medical history contributes to individual risk.</li>
<li>Assessing the impact of all the uncontrollable factors on heart attack risk.</li>
</ol></li>
</ul>
<p><strong>Modifiable Risk Factors (M)</strong></p>
<ul>
<li><p>Lifestyle &amp; Behavioral Factors, Physical &amp; Medical Indicators</p></li>
<li><p>Key analyses:</p>
<ol type="1">
<li>Examining the relationship between lifestyle behaviors and physical/medical indicators.</li>
<li>Comparing univariate and multivariate models to understand how these factors interact.</li>
</ol></li>
</ul>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">1.3 References</h2>
<ol type="1">
<li>Ministry of Health, Labour and Welfare, Japan. (2022). <em>The 2021 vital statistics</em> [in Japanese]. <a href="https://www.mhlw.go.jp/toukei/saikin/hw/jinkou/kakutei21/index.html">Link</a></li>
<li><a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC8692094/">Link to PMC article</a></li>
<li><a href="https://www.ncvc.go.jp/english/about/death-due-to-cardiovascular-disease-predicted-to-decrease-in-japan/">National Cerebral and Cardiovascular Center</a></li>
</ol>
</section>
</section>
<section id="getting-started" class="level1">
<h1>2 Getting Started</h1>
<section id="relevant-libraries" class="level2">
<h2 class="anchored" data-anchor-id="relevant-libraries">2.1 Relevant Libraries</h2>
<div class="cell">
<details class="code-fold">
<summary>Loading the relevant packages</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(broom,  </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               ComplexUpset,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               corrplot,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               easystats,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>               ggdist,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>               ggstatsplot,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>               gtsummary,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>               patchwork, </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>               SmartEDA,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>               tidyverse</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<table class="caption-top table">
<colgroup>
<col style="width: 23%">
<col style="width: 76%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Package</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>broom</strong></td>
<td>Converts statistical model outputs into tidy data frames for easy manipulation.</td>
</tr>
<tr class="even">
<td><strong>ComplexUpset</strong></td>
<td>Creates complex UpSet plots for visualizing intersections of sets.</td>
</tr>
<tr class="odd">
<td><strong>corrplot</strong></td>
<td>Visualizes correlation matrices with customizable plots.</td>
</tr>
<tr class="even">
<td><strong>easystats</strong></td>
<td>A suite of tools for statistical modeling and interpretation.</td>
</tr>
<tr class="odd">
<td><strong>ggdist</strong></td>
<td>Creates visualizations for distributions and uncertainty in ggplot2.</td>
</tr>
<tr class="even">
<td><strong>ggstatsplot</strong></td>
<td>Produces enhanced statistical plots with significance tests.</td>
</tr>
<tr class="odd">
<td><strong>gtsummary</strong></td>
<td>Creates elegant summary tables for regression models and descriptive statistics.</td>
</tr>
<tr class="even">
<td><strong>patchwork</strong></td>
<td>Combines multiple ggplot2 plots into single layouts easily.</td>
</tr>
<tr class="odd">
<td><strong>SmartEDA</strong></td>
<td>Performs automated exploratory data analysis (EDA) with summaries and visuals.</td>
</tr>
<tr class="even">
<td><strong>tidyverse</strong></td>
<td>A collection of packages for data manipulation, visualization, and analysis.</td>
</tr>
</tbody>
</table>
</section>
<section id="data-source" class="level2">
<h2 class="anchored" data-anchor-id="data-source">2.2 Data Source</h2>
<section id="about-the-data-source" class="level3">
<h3 class="anchored" data-anchor-id="about-the-data-source">2.2.1 About the Data Source</h3>
<p>The dataset was originally retrieved from <a href="https://www.kaggle.com/datasets/ashaychoudhary/heart-attack-in-japan-youth-vs-adult/data">this Kaggle repository</a>. However, as of February 16, 2025, the page is no longer accessible, and we are unable to retrieve the dataset.</p>
<p>According to the author, the dataset included:</p>
<ul>
<li><strong>Demographic data</strong> (e.g., age, sex, region)</li>
<li><strong>Medical history</strong></li>
<li><strong>Lifestyle &amp; behavioral factors</strong></li>
<li><strong>Physical &amp; medical indicators</strong></li>
<li><strong>Electrocardiographic (ECG) data</strong></li>
</ul>
<p>Further details will be discussed in the data wrangling section. We have also extracted Japan population data from <a href="https://www.populationpyramid.net/japan/2023/">here</a>.</p>
</section>
<section id="considerations-and-limitations" class="level3">
<h3 class="anchored" data-anchor-id="considerations-and-limitations">2.2.2 Considerations and Limitations</h3>
<p>Several uncertainties and limitations must be acknowledged regarding this dataset:</p>
<ol type="1">
<li><p><strong>Study Design &amp; Temporal Issues</strong></p>
<ul>
<li>This is unlikely to be a cohort study and, at best, might be a retrospective cohort study. We assume it is a <strong>case-control study</strong>, but key uncertainties remain.</li>
<li>It is unclear whether certain health indicators (e.g., BMI, physical activity levels) were recorded <strong>before or after</strong> the heart attack. This means:
<ul>
<li><strong>Reverse causation is possible</strong> (e.g., Did individuals have high BMI before their heart attack, or did they gain weight due to post-event health deterioration?).</li>
<li><strong>Behavioral changes post-heart attack</strong> could influence results (e.g., Did those with high physical activity levels increase their exercise habits after experiencing a heart attack?).</li>
</ul></li>
</ul></li>
<li><p><strong>Unclear Baseline &amp; Regional Ambiguity</strong></p>
<ul>
<li>The dataset does not clarify whether the <strong>recorded region</strong> (urban/rural) reflects where individuals lived most of their lives.</li>
<li>Migration post-heart attack could affect interpretations (e.g., Did individuals move to an urban area for better healthcare, or relocate to a rural area for a lower-stress lifestyle?).</li>
</ul></li>
<li><p><strong>Missing Information</strong></p>
<ul>
<li>No details are provided on <strong>heart attack severity</strong> (e.g., intensity, number of occurrences).</li>
</ul></li>
<li><p><strong>Potential Sampling Bias</strong></p>
<ul>
<li>Survivorship bias: Individuals who died from a heart attack may not be included, affecting representativeness.</li>
</ul></li>
<li><p><strong>Population Uncertainty</strong></p>
<ul>
<li>The dataset does not specify whether participants are <strong>Japanese nationals or residents of Japan</strong>, which could have implications for generalizability.</li>
</ul></li>
</ol>
<p>These limitations should be considered when interpreting any associations, as <strong>correlation does not imply causation</strong>, and some findings may be <strong>bidirectional</strong>.</p>
</section>
</section>
</section>
<section id="data-wrangling" class="level1">
<h1>3. Data Wrangling</h1>
<div class="cell">
<details class="code-fold">
<summary>Data import</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'data/japan_heart_attack_dataset.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="should-we-remove-the-unknown-columns" class="level2">
<h2 class="anchored" data-anchor-id="should-we-remove-the-unknown-columns">3.1 Should we remove the unknown columns?</h2>
<p>There were 15 columns named Extra_Columns_ that were provided in the dataset. The initial suspicion was that it could be the ECG data as the authors claimed that ECG data was provided.</p>
<div class="cell">
<details class="code-fold">
<summary>Visualizing the 15 unknown columns</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>original_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#ddb1b1"</span>, <span class="st">"#d0839a"</span>, <span class="st">"#8cb8c5"</span>, <span class="st">"#e7a43b"</span>, <span class="st">"#e72222"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>custom_palette <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"#d0839a"</span>, <span class="st">"#ddb1b1"</span>, <span class="st">"#8cb8c5"</span>))(<span class="dv">100</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>repeating_palette <span class="ot">&lt;-</span> <span class="fu">rep</span>(original_colors, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>df_last_15 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">tail</span>(<span class="fu">names</span>(df), <span class="dv">15</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">gsub</span>(<span class="st">"Extra_Column_"</span>, <span class="st">"Col_"</span>, .x)) </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>df_check <span class="ot">&lt;-</span> df_last_15 <span class="sc">%&gt;%</span> </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>row, <span class="at">names_to =</span> <span class="st">"sample"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>sample_lineplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_check, <span class="fu">aes</span>(<span class="at">x =</span> row, <span class="at">y =</span> value, <span class="at">color =</span> sample)) <span class="sc">+</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> repeating_palette) <span class="sc">+</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Row"</span>, <span class="at">y =</span> <span class="st">"Value"</span>, </span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"LinePlot of Extra Columns"</span>,</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Subsample of n = 100"</span>) <span class="sc">+</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>last15_corrplot <span class="ot">&lt;-</span> ggstatsplot<span class="sc">::</span><span class="fu">ggcorrmat</span>(</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_last_15, </span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">ggcorrplot.args =</span> <span class="fu">list</span>(<span class="at">outline.color =</span> <span class="st">"black"</span>, </span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>                         <span class="at">hc.order =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>                         <span class="at">tl.cex =</span> <span class="dv">10</span>),</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">colors =</span> custom_palette,</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">title    =</span> <span class="st">"Correlogram for "</span>,</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="st">"Four pairs are no significant at p &lt; 0.05"</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> sample_lineplot <span class="sc">+</span> last15_corrplot</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>combined_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exercise01_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Upon closer examination of the data, several concerning observations were made:</p>
<ol type="1">
<li>Visualization Issues: Sub-samples of the data, when plotted, do not resemble typical ECG wave-forms (Left). Another suspicion was that it could be derived features, such as single heartbeat feature (PQRST) extracted from the ECG signal and features [1].</li>
<li>Lack of Correlation: Contrary to expectations for ECG-derived features, there is no correlation observed among the features (Right). Typically, some level of correlation would be expected in signal data.</li>
<li>Statistical Analysis: A Kruskal-Wallis test using the 15 features to examine heart attack occurrence revealed no significant differences.</li>
</ol>
<p>Given these findings and in the interest of explanatory modelling, it has been decided to exclude these unknown features from further analysis. This decision is based on initial checks suggesting limited utility of these features, although a comprehensive multivariate analysis was not conducted. The focus will shift to more reliable and interpretable variables for the study of heart attack risk factors.</p>
<div class="cell">
<details class="code-fold">
<summary>Kruskal test</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df_last_16 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">tail</span>(<span class="fu">names</span>(df), <span class="dv">16</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">gsub</span>(<span class="st">"Extra_Column_"</span>, <span class="st">"Col_"</span>, .x)) </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>kwtest_stats_table <span class="ot">&lt;-</span> df_last_16 <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Col_1<span class="sc">:</span>Col_15, Heart_Attack_Occurrence) <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_summary</span>(</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> Heart_Attack_Occurrence,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic =</span> <span class="fu">list</span>(<span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="st">"{mean} ({sd})"</span>),</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">missing =</span> <span class="st">"no"</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_p</span>(</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">test =</span> <span class="fu">list</span>(<span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="st">"kruskal.test"</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_overall</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_header</span>(<span class="at">label =</span> <span class="st">"**Variable**"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_spanning_header</span>(<span class="fu">c</span>(<span class="st">"stat_1"</span>, <span class="st">"stat_2"</span>) <span class="sc">~</span> <span class="st">"**By Outcome**"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Removing the 15 columns</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>new_df <span class="ot">&lt;-</span> df[, <span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(df) <span class="sc">-</span> <span class="dv">15</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="summary-of-initial-data-checks" class="level2">
<h2 class="anchored" data-anchor-id="summary-of-initial-data-checks">3.2 Summary of Initial Data Checks</h2>
<div class="cell">
<details class="code-fold">
<summary>EDA</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>na_counts <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">is.na</span>(df)) <span class="co"># Check for missing values</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>num_report <span class="ot">&lt;-</span> <span class="fu">ExpNumViz</span>(new_df, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">Page =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>cat_report <span class="ot">&lt;-</span> <span class="fu">ExpCatViz</span>(new_df,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Page =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>EDA with target variable</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>num_w_target_report <span class="ot">&lt;-</span> <span class="fu">ExpNumViz</span>(new_df, <span class="at">target=</span><span class="st">"Heart_Attack_Occurrence"</span>,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">scatter=</span><span class="cn">TRUE</span>,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">fname=</span><span class="cn">NULL</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">Page=</span><span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>num_w_target_report2 <span class="ot">&lt;-</span> <span class="fu">ExpNumViz</span>(new_df, <span class="at">target=</span><span class="st">"Heart_Attack_Occurrence"</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">fname=</span><span class="cn">NULL</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">Page=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>cat_w_target_report <span class="ot">&lt;-</span><span class="fu">ExpCatViz</span>(new_df,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>                                <span class="at">target =</span> <span class="st">"Heart_Attack_Occurrence"</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>                                <span class="at">Page =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The code blocks above are the initial EDA tests ran. The insights are as follows:</p>
<ol type="1">
<li><strong>Distribution of Variables</strong>: Most numerical variables exhibit normal distribution patterns. Age stands out as an exception, showing a uniform distribution across the sample.</li>
<li><strong>Heart Attack Incidence</strong>: A relatively small proportion (10%) of participants reported experiencing a heart attack.</li>
<li><strong>Demographic Characteristics</strong>: Gender representation is nearly balanced in the sample. Majority of the respondents (70%) were from the Urban region.</li>
<li><strong>Relationship Between Variables and Heart Attack Occurrence</strong>:
<ol type="1">
<li><strong>Correlation Analysis</strong>: Scatter plots reveal no apparent correlations between pairs of numerical variables.</li>
<li><strong>Distribution Comparison</strong>: Boxplot analysis shows substantial overlap in the distributions of numerical variables between those who experienced heart attacks and those who did not, indicating no clear distinctions based on these variables alone.</li>
</ol></li>
</ol>
</section>
<section id="binning-numerical-variables" class="level2">
<h2 class="anchored" data-anchor-id="binning-numerical-variables">3.3 Binning Numerical Variables</h2>
<p>The intent of binning numerical variables is to obtain more interpretable odds ratios when modeling.</p>
<p>The bins are as follows:</p>
<ol type="1">
<li><p><strong>Age</strong>: The age variable is divided into 12 categories, spanning from 18 to 80 years old, with 5-year intervals (e.g., 18-24, 25-29, 30-34, etc.).</p></li>
<li><p><strong>BMI (Body Mass Index</strong>): BMI is categorized into four groups based on standard classifications [2]:</p></li>
</ol>
<ul>
<li>Underweight: Less than 18.5</li>
<li>Normal: 18.5 to less than 25</li>
<li>Pre-Obese: 25 to 30</li>
<li>Obese: 30 or greater</li>
</ul>
<ol start="3" type="1">
<li><p><strong>Cholesterol</strong>: Cholesterol levels are grouped into three categories [4]:</p>
<ul>
<li>Low: Less than 120 mg/dL</li>
<li>Normal: 120 to less than 219 mg/dL</li>
<li>High: 219 mg/dL or greater</li>
</ul></li>
<li><p><strong>Stress</strong>: Stress levels are divided into five categories based on a 0-10 scale:</p>
<ul>
<li>Very Low: 0 to 2</li>
<li>Low: 2 to 4</li>
<li>Moderate: 4 to 6</li>
<li>High: 6 to 8</li>
<li>Very High: 8 to 10</li>
</ul></li>
<li><p><strong>Heart Rate</strong>: Heart rate is categorized into eight groups, with 10 beats per minute intervals, ranging from less than 40 to 110 beats per minute.</p></li>
<li><p><strong>Blood Pressure</strong>: Blood pressure grades are categorized according to [3].</p></li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Binning variables and transforming to factors</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>age_breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">35</span>, <span class="dv">40</span>, <span class="dv">45</span>, <span class="dv">50</span>, <span class="dv">55</span>, <span class="dv">60</span>, <span class="dv">65</span>, <span class="dv">70</span>, <span class="dv">75</span>, <span class="dv">80</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>age_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"18-24"</span>, <span class="st">"25-29"</span>, <span class="st">"30-34"</span>, <span class="st">"35-39"</span>, <span class="st">"40-44"</span>, <span class="st">"45-49"</span>, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">"50-54"</span>, <span class="st">"55-59"</span>, <span class="st">"60-64"</span>, <span class="st">"65-69"</span>, <span class="st">"70-74"</span>, <span class="st">"75-79"</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>bmi_breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="fl">18.5</span>, <span class="dv">25</span>, <span class="dv">30</span>, <span class="cn">Inf</span>) </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>bmi_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Underweight (&lt;18.5)"</span>, <span class="st">"Normal (18.5 to &lt;25)"</span>, <span class="st">"Pre-Obese (25 to 30)"</span>, <span class="st">"Obese (≥30)"</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>cholesterol_breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">120</span>, <span class="dv">219</span>, <span class="cn">Inf</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>cholesterol_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Low (&lt;120)"</span>, <span class="st">"Normal (120 to &lt;219)"</span>, <span class="st">"High (≥219)"</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>stress_breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="cn">Inf</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>stress_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Very Low (0-2)"</span>, <span class="st">"Low (2-4)"</span>, <span class="st">"Moderate (4-6)"</span>, <span class="st">"High (6-8)"</span>, <span class="st">"Very High (8-10)"</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>heart_rate_breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">60</span>, <span class="dv">70</span>, <span class="dv">80</span>, <span class="dv">90</span>, <span class="dv">100</span>, <span class="dv">110</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>heart_rate_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"&lt;40"</span>, <span class="st">"40-&lt;50"</span>, <span class="st">"50-&lt;60"</span>, <span class="st">"60-&lt;70"</span>, <span class="st">"70-&lt;80"</span>, <span class="st">"80-&lt;90"</span>, <span class="st">"90-&lt;100"</span>, <span class="st">"100-&lt;110"</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>bp_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Normal"</span>, <span class="st">"High-Normal"</span>, <span class="st">"Elevated"</span>, <span class="st">"Hypertension Grade I"</span>, </span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Hypertension Grade II"</span>, <span class="st">"Hypertension (Isolated) Systolic"</span>, <span class="st">"Hypertension Grade III"</span>)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>new_df2 <span class="ot">&lt;-</span> new_df <span class="sc">%&gt;%</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age_Group =</span> <span class="fu">cut</span>(Age, <span class="at">breaks =</span> age_breaks, <span class="at">labels =</span> age_labels, <span class="at">right =</span> <span class="cn">FALSE</span>),</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(Smoking_History, Diabetes_History, Hypertension_History,</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>             Family_History, Heart_Attack_Occurrence), <span class="at">.fns =</span> <span class="sc">~+</span>(.x <span class="sc">==</span> <span class="st">"Yes"</span>)),  <span class="co"># Change from Yes No to 1, 0</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert other category to factors</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">Physical_Activity =</span> <span class="fu">factor</span>(Physical_Activity, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Low"</span>, <span class="st">"Moderate"</span>, <span class="st">"High"</span>)),</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">Diet_Quality =</span> <span class="fu">factor</span>(Diet_Quality, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Poor"</span>, <span class="st">"Average"</span>, <span class="st">"Good"</span>)),</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">Alcohol_Consumption =</span> <span class="fu">factor</span>(Alcohol_Consumption, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"None"</span>, <span class="st">"Low"</span>, <span class="st">"Moderate"</span>, <span class="st">"High"</span>)),</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Numerical variables to binned groups</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age_Group =</span> <span class="fu">factor</span>(Age_Group),</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">BMI_Group =</span> <span class="fu">cut</span>(BMI, <span class="at">breaks =</span> bmi_breaks, <span class="at">labels =</span> bmi_labels, <span class="at">right =</span> <span class="cn">FALSE</span>), </span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">BMI_Group =</span> <span class="fu">factor</span>(BMI_Group, <span class="at">levels =</span> bmi_labels),</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">Blood_Pressure =</span> <span class="fu">case_when</span>(</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>      Systolic_BP <span class="sc">&gt;=</span> <span class="dv">180</span> <span class="sc">|</span> Diastolic_BP <span class="sc">&gt;=</span> <span class="dv">110</span> <span class="sc">~</span> <span class="st">"Hypertension Grade III"</span>,</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>      Systolic_BP <span class="sc">&gt;=</span> <span class="dv">140</span> <span class="sc">&amp;</span> Diastolic_BP <span class="sc">&lt;</span> <span class="dv">90</span> <span class="sc">~</span> <span class="st">"Hypertension (Isolated) Systolic"</span>,</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>      (Systolic_BP <span class="sc">&gt;=</span> <span class="dv">160</span> <span class="sc">&amp;</span> Systolic_BP <span class="sc">&lt;=</span> <span class="dv">179</span>) <span class="sc">|</span> (Diastolic_BP <span class="sc">&gt;=</span> <span class="dv">100</span> <span class="sc">&amp;</span> Diastolic_BP <span class="sc">&lt;=</span> <span class="dv">109</span>) <span class="sc">~</span> <span class="st">"Hypertension Grade II"</span>,</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>      (Systolic_BP <span class="sc">&gt;=</span> <span class="dv">140</span> <span class="sc">&amp;</span> Systolic_BP <span class="sc">&lt;=</span> <span class="dv">159</span>) <span class="sc">|</span> (Diastolic_BP <span class="sc">&gt;=</span> <span class="dv">90</span> <span class="sc">&amp;</span> Diastolic_BP <span class="sc">&lt;=</span> <span class="dv">99</span>) <span class="sc">~</span> <span class="st">"Hypertension Grade I"</span>,</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>      (Systolic_BP <span class="sc">&gt;=</span> <span class="dv">130</span> <span class="sc">&amp;</span> Systolic_BP <span class="sc">&lt;=</span> <span class="dv">139</span>) <span class="sc">|</span> (Diastolic_BP <span class="sc">&gt;=</span> <span class="dv">80</span> <span class="sc">&amp;</span> Diastolic_BP <span class="sc">&lt;=</span> <span class="dv">89</span>) <span class="sc">~</span> <span class="st">"Elevated"</span>,</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>      Systolic_BP <span class="sc">&gt;=</span> <span class="dv">120</span> <span class="sc">&amp;</span> Systolic_BP <span class="sc">&lt;=</span> <span class="dv">129</span> <span class="sc">&amp;</span> Diastolic_BP <span class="sc">&lt;</span> <span class="dv">80</span> <span class="sc">~</span> <span class="st">"High-Normal"</span>,</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>      Systolic_BP <span class="sc">&lt;</span> <span class="dv">120</span> <span class="sc">&amp;</span> Diastolic_BP <span class="sc">&lt;</span> <span class="dv">80</span> <span class="sc">~</span> <span class="st">"Normal"</span>,</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span>  <span class="co"># Default for any values that don't match the above conditions</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">Blood_Pressure =</span> <span class="fu">factor</span>(Blood_Pressure, <span class="at">levels =</span> bp_labels),</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">Cholesterol =</span> <span class="fu">cut</span>(Cholesterol_Level, <span class="at">breaks =</span> cholesterol_breaks, <span class="at">labels =</span> cholesterol_labels, <span class="at">right =</span> <span class="cn">FALSE</span>),</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">Cholesterol =</span> <span class="fu">factor</span>(Cholesterol, <span class="at">levels =</span> cholesterol_labels),</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">Stress =</span> <span class="fu">cut</span>(Stress_Levels, <span class="at">breaks =</span> stress_breaks, <span class="at">labels =</span> stress_labels, <span class="at">right =</span> <span class="cn">FALSE</span>),</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">Stress =</span> <span class="fu">factor</span>(Stress, <span class="at">levels =</span> stress_labels),</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">Heart_Rate_Group =</span> <span class="fu">cut</span>(Heart_Rate, <span class="at">breaks =</span> heart_rate_breaks, <span class="at">labels =</span> heart_rate_labels, <span class="at">right =</span> <span class="cn">FALSE</span>),</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">Heart_Rate_Group =</span> <span class="fu">factor</span>(Heart_Rate_Group, <span class="at">levels =</span> heart_rate_labels)</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="final-description-of-the-features" class="level2">
<h2 class="anchored" data-anchor-id="final-description-of-the-features">3.4 Final Description of the Features</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 24%">
<col style="width: 24%">
<col style="width: 24%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th>Group*</th>
<th>Subgroup</th>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>U</td>
<td>Demographics</td>
<td>Age</td>
<td>Range from 18 - 79</td>
</tr>
<tr class="even">
<td>U</td>
<td>Demographics</td>
<td>Age Group</td>
<td>Binned age in intervals of 5, with the exception of 18-24</td>
</tr>
<tr class="odd">
<td>U</td>
<td>Demographics</td>
<td>Gender</td>
<td>Male, Female</td>
</tr>
<tr class="even">
<td>U</td>
<td>Demographics</td>
<td>Region</td>
<td>Urban, Rural</td>
</tr>
<tr class="odd">
<td>U</td>
<td>Medical History</td>
<td>Smoking History</td>
<td>Yes, No</td>
</tr>
<tr class="even">
<td>U</td>
<td>Medical History</td>
<td>Diabetes History</td>
<td>Yes, No</td>
</tr>
<tr class="odd">
<td>U</td>
<td>Medical History</td>
<td>Hypertension History</td>
<td>Yes, No</td>
</tr>
<tr class="even">
<td>U</td>
<td>Medical History</td>
<td>Family History</td>
<td>Yes, No</td>
</tr>
<tr class="odd">
<td>M</td>
<td>Lifestyle &amp; Behavioral Factors</td>
<td>Physical Activity</td>
<td>Moderate, Low, High</td>
</tr>
<tr class="even">
<td>M</td>
<td>Lifestyle &amp; Behavioral Factors</td>
<td>Diet Quality</td>
<td>Poor, Good, Average</td>
</tr>
<tr class="odd">
<td>M</td>
<td>Lifestyle &amp; Behavioral Factors</td>
<td>Alcohol Consumption</td>
<td>None, Low, Moderate, High</td>
</tr>
<tr class="even">
<td>M</td>
<td>Physical and Medical Indicators</td>
<td>BMI</td>
<td>Range from 5.5 - 46.1</td>
</tr>
<tr class="odd">
<td>M</td>
<td>Physical and Medical Indicators</td>
<td>BMI Group</td>
<td>Binned BMI according to [2]</td>
</tr>
<tr class="even">
<td>M</td>
<td>Physical and Medical Indicators</td>
<td>Heart Rate</td>
<td>Range from 30 - 110</td>
</tr>
<tr class="odd">
<td>M</td>
<td>Physical and Medical Indicators</td>
<td>Heart Rate Group</td>
<td>Binned by intervals of 10</td>
</tr>
<tr class="even">
<td>M</td>
<td>Physical and Medical Indicators</td>
<td>Cholesterol Level</td>
<td>Range from 80 - 337</td>
</tr>
<tr class="odd">
<td>M</td>
<td>Physical and Medical Indicators</td>
<td>Cholesterol</td>
<td>Binned as Low, Normal, and High according to [4]</td>
</tr>
<tr class="even">
<td>M</td>
<td>Physical and Medical Indicators</td>
<td>Systolic BP</td>
<td>Range from 56 - 179</td>
</tr>
<tr class="odd">
<td>M</td>
<td>Physical and Medical Indicators</td>
<td>Diastolic BP</td>
<td>Range from 39 - 118</td>
</tr>
<tr class="even">
<td>M</td>
<td>Physical and Medical Indicators</td>
<td>Blood Pressure</td>
<td>Binned according to [3] using systolic and diastolic BP</td>
</tr>
<tr class="odd">
<td>M</td>
<td>Physical and Medical Indicators</td>
<td>Stress Levels</td>
<td>Range from 0 - 10</td>
</tr>
<tr class="even">
<td>M</td>
<td>Physical and Medical Indicators</td>
<td>Stress</td>
<td>Binned by intervals of 2 points</td>
</tr>
<tr class="odd">
<td>O</td>
<td></td>
<td>Heart Attack Occurrence</td>
<td>Yes, No</td>
</tr>
</tbody>
</table>
<p>*<em>U: Uncontrolled Factors, M: Modifiable Factors, O: Outcome</em></p>
</section>
<section id="references-1" class="level2">
<h2 class="anchored" data-anchor-id="references-1">3.5 References</h2>
<ol type="1">
<li><a href="https://www.sciencedirect.com/science/article/pii/S2772442522000612">A machine learning approach for classifying healthy and infarcted patients using heart rate variabilities derived vector magnitude</a></li>
<li><a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC8479451/#bib0012">JSH 2019 Office Guidelines</a></li>
<li><a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC6875598/">Key Points of the 2019 Japanese Society of Hypertension Guidelines for the Management of Hypertension</a></li>
<li><a href="https://www.hc.u-tokyo.ac.jp/en/checkupresult/explanation/lipid/">Total Cholesterol Range</a></li>
</ol>
</section>
</section>
<section id="data-analysis" class="level1">
<h1>4. Data Analysis</h1>
<section id="how-do-age-and-gender-shape-heart-attack-risk" class="level2">
<h2 class="anchored" data-anchor-id="how-do-age-and-gender-shape-heart-attack-risk">4.1 How Do Age and Gender Shape Heart Attack Risk?</h2>
<div class="cell">
<details class="code-fold">
<summary>Converting japan population data</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>japan_pop <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'data/japan_pop_2023.csv'</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the row where Age == "15 - 19"</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>age_15_19 <span class="ot">&lt;-</span> japan_pop <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Age <span class="sc">==</span> <span class="st">"15-19"</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the adjusted counts for ages 18 and 19</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>adjusted_M <span class="ot">&lt;-</span> (age_15_19<span class="sc">$</span>M <span class="sc">/</span> <span class="dv">5</span>) <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>adjusted_F <span class="ot">&lt;-</span> (age_15_19<span class="sc">$</span>F <span class="sc">/</span> <span class="dv">5</span>) <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>japan_pop <span class="ot">&lt;-</span> japan_pop <span class="sc">%&gt;%</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find the row where Age == "20 - 24" and add the adjusted counts</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">M =</span> <span class="fu">ifelse</span>(Age <span class="sc">==</span> <span class="st">"20-24"</span>, M <span class="sc">+</span> adjusted_M, M),</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">F =</span> <span class="fu">ifelse</span>(Age <span class="sc">==</span> <span class="st">"20-24"</span>, F <span class="sc">+</span> adjusted_F, F)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Change the Age value for "20-24" to "18-24"</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age =</span> <span class="fu">ifelse</span>(Age <span class="sc">==</span> <span class="st">"20-24"</span>, <span class="st">"18-24"</span>, Age)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age <span class="sc">%in%</span> age_labels)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>japan_pop <span class="ot">&lt;-</span> japan_pop <span class="sc">%&gt;%</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(M, F), <span class="at">names_to =</span> <span class="st">"Gender"</span>, <span class="at">values_to =</span> <span class="st">"Count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Proportion =</span> Count <span class="sc">/</span> <span class="fu">sum</span>(Count)) <span class="sc">%&gt;%</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age =</span> <span class="fu">factor</span>(Age, <span class="at">levels=</span>age_labels),</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">Gender =</span> <span class="fu">factor</span>(Gender)) <span class="sc">%&gt;%</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">percent =</span> <span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span>(Count <span class="sc">/</span> <span class="fu">sum</span>(Count, <span class="at">na.rm=</span>T)),<span class="dv">1</span>),  <span class="co"># calculate % of total for age-gender groups</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">percent =</span> <span class="fu">case_when</span>(                                     <span class="co"># convert % to negative if male</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>        Gender <span class="sc">==</span> <span class="st">"F"</span> <span class="sc">~</span> percent,</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>        Gender <span class="sc">==</span> <span class="st">"M"</span> <span class="sc">~</span> <span class="sc">-</span>percent,</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span>          <span class="sc">~</span> <span class="cn">NA_real_</span>),</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">Gender =</span> <span class="fu">factor</span>(Gender, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"F"</span>, <span class="st">"M"</span>))</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Age, Gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Data conversion for plotting the pyramid plot</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>convert_to_pyramid_data <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(Age_Group, Gender, <span class="at">name =</span> <span class="st">"counts"</span>) <span class="sc">%&gt;%</span>  <span class="co"># counts by age-gender groups</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">percent =</span> <span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span>(counts <span class="sc">/</span> <span class="fu">sum</span>(counts, <span class="at">na.rm=</span>T)),<span class="dv">1</span>),  <span class="co"># calculate % of total for age-gender groups</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">percent =</span> <span class="fu">case_when</span>(                                     <span class="co"># convert % to negative if male</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>        Gender <span class="sc">==</span> <span class="st">"Female"</span> <span class="sc">~</span> percent,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>        Gender <span class="sc">==</span> <span class="st">"Male"</span> <span class="sc">~</span> <span class="sc">-</span>percent,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span>          <span class="sc">~</span> <span class="cn">NA_real_</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>pop_data <span class="ot">&lt;-</span> <span class="fu">convert_to_pyramid_data</span>(new_df2)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>ha_data <span class="ot">&lt;-</span> <span class="fu">convert_to_pyramid_data</span>(new_df2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Heart_Attack_Occurrence <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>pyramid_data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(<span class="st">"cases"</span> <span class="ot">=</span> ha_data, <span class="st">"population"</span> <span class="ot">=</span> pop_data, <span class="at">.id =</span> <span class="st">"data_source"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Plotting the two age-sex pyramid</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>max_per <span class="ot">&lt;-</span> <span class="fu">max</span>(pyramid_data<span class="sc">$</span>percent, <span class="at">na.rm=</span>T)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>min_per <span class="ot">&lt;-</span> <span class="fu">min</span>(pyramid_data<span class="sc">$</span>percent, <span class="at">na.rm=</span>T)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The japan population data</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> japan_pop,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> Age,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> percent,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> Gender),</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"black"</span>,                             </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">1</span>)  <span class="sc">+</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> age_labels) <span class="sc">+</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"F"</span> <span class="ot">=</span> <span class="st">"#d0839a"</span>,</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>               <span class="st">"M"</span> <span class="ot">=</span> <span class="st">"#8cb8c5"</span>),</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"F"</span> <span class="ot">=</span> <span class="st">"Female"</span>,</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>               <span class="st">"M"</span><span class="ot">=</span> <span class="st">"Male"</span>),</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(min_per, max_per),                                         </span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fu">floor</span>(min_per), <span class="fu">ceiling</span>(max_per), <span class="at">by =</span> <span class="dv">2</span>),                </span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">paste0</span>(                                                      </span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>              <span class="fu">abs</span>(<span class="fu">seq</span>(<span class="fu">floor</span>(min_per), <span class="fu">ceiling</span>(max_per), <span class="at">by =</span> <span class="dv">2</span>)), <span class="st">"%"</span>)) <span class="sc">+</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Age and gender distribution of Japan population"</span>,</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Percentage of Total (%)"</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># optional aesthetic themes                    </span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>), </span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>, <span class="at">size=</span><span class="dv">11</span>, <span class="at">face =</span> <span class="st">"italic"</span>))</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> pop_data,</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> Age_Group,</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> percent,</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> Gender),</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"black"</span>,                             </span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">1</span>)  <span class="sc">+</span></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> age_labels) <span class="sc">+</span></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Female"</span> <span class="ot">=</span> <span class="st">"#d0839a"</span>,</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Male"</span> <span class="ot">=</span> <span class="st">"#8cb8c5"</span>),</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Female"</span> <span class="ot">=</span> <span class="st">"Female"</span>,</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Male"</span><span class="ot">=</span> <span class="st">"Male"</span>),</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(min_per, max_per),                                         </span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fu">floor</span>(min_per), <span class="fu">ceiling</span>(max_per), <span class="at">by =</span> <span class="dv">2</span>),                </span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">paste0</span>(                                                      </span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>              <span class="fu">abs</span>(<span class="fu">seq</span>(<span class="fu">floor</span>(min_per), <span class="fu">ceiling</span>(max_per), <span class="at">by =</span> <span class="dv">2</span>)), <span class="st">"%"</span>)) <span class="sc">+</span></span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Age and gender distribution of sample"</span>,</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Percentage of Total (%)"</span>) <span class="sc">+</span> </span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>        <span class="co"># optional aesthetic themes                    </span></span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>), </span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>, <span class="at">size=</span><span class="dv">11</span>, <span class="at">face =</span> <span class="st">"italic"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Weighting the percentage based on the japan population</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>weights <span class="ot">&lt;-</span> japan_pop<span class="sc">$</span>percent<span class="sc">/</span>pop_data<span class="sc">$</span>percent </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>pop_data<span class="sc">$</span>weighted_pct <span class="ot">&lt;-</span> pop_data<span class="sc">$</span>percent <span class="sc">*</span> weights</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>ha_data<span class="sc">$</span>weighted_pct <span class="ot">&lt;-</span> ha_data<span class="sc">$</span>percent <span class="sc">*</span> weights</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>pyramid_data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(<span class="st">"cases"</span> <span class="ot">=</span> ha_data, <span class="st">"population"</span> <span class="ot">=</span> pop_data, <span class="at">.id =</span> <span class="st">"data_source"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Plotting the entire age-sex pyramid</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># From here https://epirhandbook.com/en/new_pages/age_pyramid.html </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span>  </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> pyramid_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(data_source <span class="sc">==</span> <span class="st">"population"</span>),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> Age_Group,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> weighted_pct,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> Gender),</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"black"</span>,                               <span class="co"># black color around bars</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.2</span>,                                    <span class="co"># more transparent</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">1</span>)<span class="sc">+</span>                                     <span class="co"># full width</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> pyramid_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(data_source <span class="sc">==</span> <span class="st">"cases"</span>), </span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> Age_Group,                               <span class="co"># age categories as original X axis</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> weighted_pct,                                <span class="co"># % as original Y-axis</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> Gender),                             <span class="co"># fill of bars by gender</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"black"</span>,                               <span class="co"># black color around bars</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="dv">1</span>,                                      <span class="co"># not transparent </span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.3</span>)<span class="sc">+</span>                                   <span class="co"># half width</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> age_labels) <span class="sc">+</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(min_per, max_per),                                         </span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fu">floor</span>(min_per), <span class="fu">ceiling</span>(max_per), <span class="at">by =</span> <span class="dv">2</span>),              </span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">paste0</span>(                                                     </span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>              <span class="fu">abs</span>(<span class="fu">seq</span>(<span class="fu">floor</span>(min_per), <span class="fu">ceiling</span>(max_per), <span class="at">by =</span> <span class="dv">2</span>)), <span class="st">"%"</span>))<span class="sc">+</span>                                                  </span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># designate colors and legend labels manually</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Female"</span> <span class="ot">=</span> <span class="st">"#d0839a"</span>,</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Male"</span> <span class="ot">=</span> <span class="st">"#8cb8c5"</span>),</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Female"</span> <span class="ot">=</span> <span class="st">"Female"</span>,</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Male"</span><span class="ot">=</span> <span class="st">"Male"</span>), </span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot labels, titles, caption    </span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Age and gender distribution of respondents with heart attack,</span><span class="sc">\n</span><span class="st">as compared to baseline population"</span>,</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"The age and gender distribution has been weighted based on the Japan population"</span>,</span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age Category"</span>,</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Weighted Percentage of Total (%)"</span>,</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="cn">NULL</span>,</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> stringr<span class="sc">::</span><span class="fu">str_glue</span>(<span class="st">"Cases shown on top of adjusted sample demographic baseline</span><span class="sc">\n</span><span class="st">Data from Kaggle, n = {nrow(df)}"</span>)) <span class="sc">+</span></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># optional aesthetic themes</span></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,                             <span class="co"># move legend to bottom</span></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>), </span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>, <span class="at">size=</span><span class="dv">11</span>, <span class="at">face =</span> <span class="st">"italic"</span>))</span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>(p1<span class="sc">+</span>p2)<span class="sc">/</span>p3 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exercise01_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This visualization presents a <strong>comparative analysis of age and gender distributions</strong> across three different populations:</p>
<ol type="1">
<li><strong>Japan’s General Population</strong> (Top-left)
<ul>
<li>Shows the natural age and gender distribution in Japan.</li>
<li>Males and females are represented by different colors.</li>
</ul></li>
<li><strong>Study Sample Distribution</strong> (Top-right)
<ul>
<li>Represents the age and gender composition of the dataset used for analysis.</li>
<li>Helps assess how well the sample represents the actual Japanese population.</li>
</ul></li>
<li><strong>Heart Attack Cases (Bottom Panel, Weighted by Japan’s Population)</strong>
<ul>
<li>Illustrates the age and gender distribution of individuals who reported heart attack occurrences.</li>
<li>Bars in the background represent the adjusted (based on population distributed) baseline sample distribution</li>
<li>The <strong>darker bars show the proportion of heart attack cases</strong>, allowing for direct comparison - if the bars are outside the baseline, means this group has larger representation in the heart attack cases.</li>
</ul></li>
</ol>
<p>The key observations are:</p>
<ul>
<li><strong>Higher Heart Attack Incidence in Older Age Groups:</strong> The proportion of heart attack cases increases with age, especially in individuals aged <strong>50 and above</strong>.</li>
<li><strong>Gender Differences:</strong>
<ul>
<li>Males have a <strong>higher representation</strong> in heart attack cases compared to females in most age groups.</li>
<li>This pattern aligns with existing medical research suggesting that men are at a <strong>higher risk of cardiovascular diseases</strong> at younger ages.</li>
</ul></li>
<li><strong>Lower Incidence in Younger Groups</strong>:
<ul>
<li>The 18-29 age group has the lowest proportion of heart attack cases, aligning with the expected lower risk for younger individuals.</li>
</ul></li>
<li><strong>Sample Representativeness:</strong>
<ul>
<li>The sample (top-right) appears to be well-distributed compared to the general Japanese population (top-left), suggesting that findings may be broadly applicable.</li>
</ul></li>
</ul>
</section>
<section id="does-your-medical-history-decide-your-heart-attack-risk" class="level2">
<h2 class="anchored" data-anchor-id="does-your-medical-history-decide-your-heart-attack-risk">4.2 Does Your Medical History Decide Your Heart Attack Risk?</h2>
<div class="cell">
<details class="code-fold">
<summary>Creating the combination plot</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>mean_proportion <span class="ot">&lt;-</span> <span class="fu">mean</span>(new_df2<span class="sc">$</span>Heart_Attack_Occurrence, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>mean_BMI <span class="ot">&lt;-</span> <span class="fu">mean</span>(new_df2<span class="sc">$</span>BMI, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>new_df2<span class="sc">$</span>Heart_Attack_Occurrence2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(new_df2<span class="sc">$</span>Heart_Attack_Occurrence, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>))</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> ComplexUpset<span class="sc">::</span><span class="fu">upset</span>(new_df2, </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"Smoking_History"</span>, <span class="st">"Diabetes_History"</span>, <span class="st">"Hypertension_History"</span>, <span class="st">"Family_History"</span>), </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">name=</span><span class="st">'Medical History'</span>,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">base_annotations=</span><span class="fu">list</span>(</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Intersection size'</span><span class="ot">=</span><span class="fu">intersection_size</span>()</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotations =</span> <span class="fu">list</span>(</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Heart Attack Occurrence'</span><span class="ot">=</span><span class="fu">list</span>(</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">aes =</span> <span class="fu">aes</span>(<span class="at">x =</span> intersection, <span class="at">fill =</span> Heart_Attack_Occurrence2),</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">geom =</span> <span class="fu">list</span>(</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>                <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">'count'</span>, <span class="at">position =</span> <span class="st">'fill'</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>                <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> mean_proportion, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>                <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="cn">Inf</span>, <span class="at">y =</span> mean_proportion, </span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, mean_proportion<span class="sc">*</span><span class="dv">100</span>),  <span class="co"># Annotate with a % at the end. </span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">hjust =</span> <span class="fl">1.4</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>),</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>                <span class="fu">scale_fill_manual</span>(</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="st">"Heart Attack"</span>,</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"0"</span> <span class="ot">=</span> <span class="fu">alpha</span>(<span class="st">"#e7a43b"</span>, <span class="fl">0.8</span>), <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"#e72222"</span>),  </span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="st">"Yes"</span>, <span class="st">"0"</span> <span class="ot">=</span> <span class="st">"No"</span>)</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>                ),</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_text</span>(</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">aes</span>(</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label=</span><span class="sc">!!</span><span class="fu">aes_percentage</span>(<span class="at">relative_to=</span><span class="st">'intersection'</span>),</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>                        <span class="at">group=</span>Heart_Attack_Occurrence2</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>                    ),</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>                    <span class="at">stat=</span><span class="st">'count'</span>,</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>                    <span class="at">position=</span><span class="fu">position_fill</span>(<span class="at">vjust =</span> .<span class="dv">5</span>)</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>                ),</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>                <span class="fu">scale_y_continuous</span>(<span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">percent_format</span>())</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>            ))</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">width_ratio =</span> <span class="fl">0.1</span>,</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">wrap=</span><span class="cn">TRUE</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Impact of Medical History on Heart Attack Occurrence: An Upset and Proportional Analysis"</span>)</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exercise01_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p>This visualization consists of two key components:</p>
<ol type="1">
<li><strong>Stacked Bar Plot (Top Panel) – Heart Attack Occurrence by Medical History Intersection</strong>:
<ul>
<li>Each bar represents a specific combination of medical history factors (Smoking, Family History, Hypertension, Diabetes). The red portion (percentage labeled) represents individuals who experienced a heart attack, while the orange portion represents those who did not.</li>
<li>The proportion of heart attack occurrences ranges from 9% to 14%, indicating that certain medical history combinations are associated with a higher likelihood of heart attacks.</li>
<li>The highest risk categories (12–14% heart attack rate) involve individuals with multiple conditions, such as hypertension, diabetes, and smoking history.</li>
</ul></li>
</ol>
<!-- -->
<ol start="2" type="1">
<li><strong>Upset Plot (Bottom Panel) – Medical History Combinations and Frequencies</strong>:
<ul>
<li>The bar heights indicate the number of individuals in each medical history category.</li>
<li>The largest group (8,791 individuals) has no recorded medical history of these conditions.</li>
<li>Other major groups include individuals with family history, hypertension, and smoking history in different combinations.</li>
<li>The dots below the bars indicate the specific medical conditions present in each group, with multiple black dots showing co-occurring risk factors.</li>
<li>Groups with three or more risk factors have fewer individuals but show higher heart attack rates, reinforcing the cumulative effect of these conditions.</li>
</ul></li>
</ol>
<p><strong>Individuals with multiple risk factors (e.g., smoking + hypertension + diabetes) are at higher risk of heart attacks compared to the average</strong>. Preventive measures should focus on individuals with multiple risk factors, as they represent the highest-risk categories.</p>
</section>
<section id="how-do-uncontrollable-factors-interact-in-determining-your-heart-attack-risk" class="level2">
<h2 class="anchored" data-anchor-id="how-do-uncontrollable-factors-interact-in-determining-your-heart-attack-risk">4.3 How Do Uncontrollable Factors Interact in Determining Your Heart Attack Risk?</h2>
<div class="cell">
<details class="code-fold">
<summary>Univariate regression</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>univ_tab <span class="ot">&lt;-</span> <span class="fu">tbl_uvregression</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    new_df2,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> glm,                           <span class="do">## define regression want to run (generalised linear model)</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> Heart_Attack_Occurrence,   </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">include =</span> <span class="fu">c</span>(</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Age_Group"</span>, <span class="st">"Gender"</span>, <span class="st">"Region"</span>, </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Smoking_History"</span>, <span class="st">"Diabetes_History"</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Hypertension_History"</span>, <span class="st">"Family_History"</span>),</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> binomial),  <span class="do">## define what type of glm want to run (logistic)</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">exponentiate =</span> <span class="cn">TRUE</span>                     <span class="do">## exponentiate to produce odds ratios (rather than log odds)</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Multivariate regression</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>explanatory_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Age_Group"</span>, <span class="st">"Gender"</span>, <span class="st">"Region"</span>, <span class="st">"Smoking_History"</span>, <span class="st">"Diabetes_History"</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Hypertension_History"</span>, <span class="st">"Family_History"</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>mv_reg <span class="ot">&lt;-</span> explanatory_vars <span class="sc">%&gt;%</span>  <span class="do">## begin with vector of explanatory column names</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_c</span>(<span class="at">collapse =</span> <span class="st">"+"</span>) <span class="sc">%&gt;%</span>     <span class="do">## combine all names of the variables of interest separated by a plus</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_c</span>(<span class="st">"Heart_Attack_Occurrence ~ "</span>, .) <span class="sc">%&gt;%</span>    <span class="do">## combine the names of variables of interest with outcome in formula style</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(<span class="at">family =</span> <span class="st">"binomial"</span>,      <span class="do">## define type of glm as logistic,</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> new_df2)          <span class="do">## define your dataset</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>final_mv_reg <span class="ot">&lt;-</span> mv_reg <span class="sc">%&gt;%</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step</span>(<span class="at">direction =</span> <span class="st">"forward"</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>mv_tab <span class="ot">&lt;-</span> <span class="fu">tbl_regression</span>(final_mv_reg, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Merge regression results</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_merge</span>(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">tbls =</span> <span class="fu">list</span>(univ_tab, mv_tab),                          <span class="co"># combine</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">tab_spanner =</span> <span class="fu">c</span>(<span class="st">"**Univariate**"</span>, <span class="st">"**Multivariate**"</span>)) <span class="co"># set header names</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="coulidugyk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#coulidugyk table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#coulidugyk thead, #coulidugyk tbody, #coulidugyk tfoot, #coulidugyk tr, #coulidugyk td, #coulidugyk th {
  border-style: none;
}

#coulidugyk p {
  margin: 0;
  padding: 0;
}

#coulidugyk .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#coulidugyk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#coulidugyk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#coulidugyk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#coulidugyk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#coulidugyk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#coulidugyk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#coulidugyk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#coulidugyk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#coulidugyk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#coulidugyk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#coulidugyk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#coulidugyk .gt_spanner_row {
  border-bottom-style: hidden;
}

#coulidugyk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#coulidugyk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#coulidugyk .gt_from_md > :first-child {
  margin-top: 0;
}

#coulidugyk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#coulidugyk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#coulidugyk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#coulidugyk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#coulidugyk .gt_row_group_first td {
  border-top-width: 2px;
}

#coulidugyk .gt_row_group_first th {
  border-top-width: 2px;
}

#coulidugyk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#coulidugyk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#coulidugyk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#coulidugyk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#coulidugyk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#coulidugyk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#coulidugyk .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#coulidugyk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#coulidugyk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#coulidugyk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#coulidugyk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#coulidugyk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#coulidugyk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#coulidugyk .gt_left {
  text-align: left;
}

#coulidugyk .gt_center {
  text-align: center;
}

#coulidugyk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#coulidugyk .gt_font_normal {
  font-weight: normal;
}

#coulidugyk .gt_font_bold {
  font-weight: bold;
}

#coulidugyk .gt_font_italic {
  font-style: italic;
}

#coulidugyk .gt_super {
  font-size: 65%;
}

#coulidugyk .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#coulidugyk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#coulidugyk .gt_indent_1 {
  text-indent: 5px;
}

#coulidugyk .gt_indent_2 {
  text-indent: 10px;
}

#coulidugyk .gt_indent_3 {
  text-indent: 15px;
}

#coulidugyk .gt_indent_4 {
  text-indent: 20px;
}

#coulidugyk .gt_indent_5 {
  text-indent: 25px;
}

#coulidugyk .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#coulidugyk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="gt_col_headings gt_spanner_row header">
<th rowspan="2" id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th colspan="4" id="**Univariate**" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
<strong>Univariate</strong>
</div></th>
<th colspan="3" id="**Multivariate**" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
<strong>Multivariate</strong>
</div></th>
</tr>
<tr class="gt_col_headings even">
<th id="stat_n_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>N</strong></th>
<th id="estimate_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>OR</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="conf.low_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="p.value_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
<th id="estimate_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>OR</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="conf.low_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="p.value_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">Age_Group</td>
<td class="gt_row gt_center" headers="stat_n_1">30,000</td>
<td class="gt_row gt_center" headers="estimate_1"><br>
</td>
<td class="gt_row gt_center" headers="conf.low_1"><br>
</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2"><br>
</td>
<td class="gt_row gt_center" headers="conf.low_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;18-24</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">—</td>
<td class="gt_row gt_center" headers="conf.low_1">—</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2">—</td>
<td class="gt_row gt_center" headers="conf.low_2">—</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;25-29</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">0.98</td>
<td class="gt_row gt_center" headers="conf.low_1">0.81, 1.17</td>
<td class="gt_row gt_center" headers="p.value_1">0.8</td>
<td class="gt_row gt_center" headers="estimate_2">0.98</td>
<td class="gt_row gt_center" headers="conf.low_2">0.81, 1.17</td>
<td class="gt_row gt_center" headers="p.value_2">0.8</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;30-34</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">1.14</td>
<td class="gt_row gt_center" headers="conf.low_1">0.96, 1.35</td>
<td class="gt_row gt_center" headers="p.value_1">0.14</td>
<td class="gt_row gt_center" headers="estimate_2">1.14</td>
<td class="gt_row gt_center" headers="conf.low_2">0.96, 1.36</td>
<td class="gt_row gt_center" headers="p.value_2">0.14</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;35-39</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">1.22</td>
<td class="gt_row gt_center" headers="conf.low_1">1.03, 1.45</td>
<td class="gt_row gt_center" headers="p.value_1">0.023</td>
<td class="gt_row gt_center" headers="estimate_2">1.22</td>
<td class="gt_row gt_center" headers="conf.low_2">1.03, 1.45</td>
<td class="gt_row gt_center" headers="p.value_2">0.023</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;40-44</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">1.16</td>
<td class="gt_row gt_center" headers="conf.low_1">0.97, 1.38</td>
<td class="gt_row gt_center" headers="p.value_1">0.10</td>
<td class="gt_row gt_center" headers="estimate_2">1.16</td>
<td class="gt_row gt_center" headers="conf.low_2">0.97, 1.38</td>
<td class="gt_row gt_center" headers="p.value_2">0.10</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;45-49</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">0.96</td>
<td class="gt_row gt_center" headers="conf.low_1">0.80, 1.15</td>
<td class="gt_row gt_center" headers="p.value_1">0.6</td>
<td class="gt_row gt_center" headers="estimate_2">0.96</td>
<td class="gt_row gt_center" headers="conf.low_2">0.79, 1.15</td>
<td class="gt_row gt_center" headers="p.value_2">0.6</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;50-54</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">1.17</td>
<td class="gt_row gt_center" headers="conf.low_1">0.98, 1.40</td>
<td class="gt_row gt_center" headers="p.value_1">0.081</td>
<td class="gt_row gt_center" headers="estimate_2">1.17</td>
<td class="gt_row gt_center" headers="conf.low_2">0.98, 1.39</td>
<td class="gt_row gt_center" headers="p.value_2">0.084</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;55-59</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">1.16</td>
<td class="gt_row gt_center" headers="conf.low_1">0.97, 1.38</td>
<td class="gt_row gt_center" headers="p.value_1">0.11</td>
<td class="gt_row gt_center" headers="estimate_2">1.16</td>
<td class="gt_row gt_center" headers="conf.low_2">0.97, 1.38</td>
<td class="gt_row gt_center" headers="p.value_2">0.11</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;60-64</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">1.14</td>
<td class="gt_row gt_center" headers="conf.low_1">0.95, 1.36</td>
<td class="gt_row gt_center" headers="p.value_1">0.15</td>
<td class="gt_row gt_center" headers="estimate_2">1.14</td>
<td class="gt_row gt_center" headers="conf.low_2">0.95, 1.36</td>
<td class="gt_row gt_center" headers="p.value_2">0.15</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;65-69</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">0.97</td>
<td class="gt_row gt_center" headers="conf.low_1">0.81, 1.16</td>
<td class="gt_row gt_center" headers="p.value_1">0.7</td>
<td class="gt_row gt_center" headers="estimate_2">0.97</td>
<td class="gt_row gt_center" headers="conf.low_2">0.81, 1.16</td>
<td class="gt_row gt_center" headers="p.value_2">0.7</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;70-74</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">1.07</td>
<td class="gt_row gt_center" headers="conf.low_1">0.89, 1.28</td>
<td class="gt_row gt_center" headers="p.value_1">0.5</td>
<td class="gt_row gt_center" headers="estimate_2">1.07</td>
<td class="gt_row gt_center" headers="conf.low_2">0.90, 1.28</td>
<td class="gt_row gt_center" headers="p.value_2">0.5</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;75-79</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">1.18</td>
<td class="gt_row gt_center" headers="conf.low_1">0.99, 1.40</td>
<td class="gt_row gt_center" headers="p.value_1">0.067</td>
<td class="gt_row gt_center" headers="estimate_2">1.18</td>
<td class="gt_row gt_center" headers="conf.low_2">0.99, 1.41</td>
<td class="gt_row gt_center" headers="p.value_2">0.064</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Gender</td>
<td class="gt_row gt_center" headers="stat_n_1">30,000</td>
<td class="gt_row gt_center" headers="estimate_1"><br>
</td>
<td class="gt_row gt_center" headers="conf.low_1"><br>
</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2"><br>
</td>
<td class="gt_row gt_center" headers="conf.low_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Female</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">—</td>
<td class="gt_row gt_center" headers="conf.low_1">—</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2">—</td>
<td class="gt_row gt_center" headers="conf.low_2">—</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Male</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">1.07</td>
<td class="gt_row gt_center" headers="conf.low_1">0.99, 1.16</td>
<td class="gt_row gt_center" headers="p.value_1">0.073</td>
<td class="gt_row gt_center" headers="estimate_2">1.07</td>
<td class="gt_row gt_center" headers="conf.low_2">0.99, 1.16</td>
<td class="gt_row gt_center" headers="p.value_2">0.070</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Region</td>
<td class="gt_row gt_center" headers="stat_n_1">30,000</td>
<td class="gt_row gt_center" headers="estimate_1"><br>
</td>
<td class="gt_row gt_center" headers="conf.low_1"><br>
</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2"><br>
</td>
<td class="gt_row gt_center" headers="conf.low_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Rural</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">—</td>
<td class="gt_row gt_center" headers="conf.low_1">—</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2">—</td>
<td class="gt_row gt_center" headers="conf.low_2">—</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Urban</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">1.00</td>
<td class="gt_row gt_center" headers="conf.low_1">0.92, 1.09</td>
<td class="gt_row gt_center" headers="p.value_1">&gt;0.9</td>
<td class="gt_row gt_center" headers="estimate_2">1.00</td>
<td class="gt_row gt_center" headers="conf.low_2">0.92, 1.09</td>
<td class="gt_row gt_center" headers="p.value_2">&gt;0.9</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Smoking_History</td>
<td class="gt_row gt_center" headers="stat_n_1">30,000</td>
<td class="gt_row gt_center" headers="estimate_1">1.05</td>
<td class="gt_row gt_center" headers="conf.low_1">0.97, 1.14</td>
<td class="gt_row gt_center" headers="p.value_1">0.2</td>
<td class="gt_row gt_center" headers="estimate_2">1.05</td>
<td class="gt_row gt_center" headers="conf.low_2">0.97, 1.14</td>
<td class="gt_row gt_center" headers="p.value_2">0.2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Diabetes_History</td>
<td class="gt_row gt_center" headers="stat_n_1">30,000</td>
<td class="gt_row gt_center" headers="estimate_1">1.06</td>
<td class="gt_row gt_center" headers="conf.low_1">0.97, 1.17</td>
<td class="gt_row gt_center" headers="p.value_1">0.2</td>
<td class="gt_row gt_center" headers="estimate_2">1.07</td>
<td class="gt_row gt_center" headers="conf.low_2">0.97, 1.17</td>
<td class="gt_row gt_center" headers="p.value_2">0.2</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Hypertension_History</td>
<td class="gt_row gt_center" headers="stat_n_1">30,000</td>
<td class="gt_row gt_center" headers="estimate_1">1.03</td>
<td class="gt_row gt_center" headers="conf.low_1">0.94, 1.12</td>
<td class="gt_row gt_center" headers="p.value_1">0.5</td>
<td class="gt_row gt_center" headers="estimate_2">1.03</td>
<td class="gt_row gt_center" headers="conf.low_2">0.94, 1.12</td>
<td class="gt_row gt_center" headers="p.value_2">0.5</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Family_History</td>
<td class="gt_row gt_center" headers="stat_n_1">30,000</td>
<td class="gt_row gt_center" headers="estimate_1">0.99</td>
<td class="gt_row gt_center" headers="conf.low_1">0.91, 1.08</td>
<td class="gt_row gt_center" headers="p.value_1">0.8</td>
<td class="gt_row gt_center" headers="estimate_2">0.99</td>
<td class="gt_row gt_center" headers="conf.low_2">0.91, 1.07</td>
<td class="gt_row gt_center" headers="p.value_2">0.8</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="8" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> OR = Odds Ratio, CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>The table presents the odds ratios and confidence intervals for various factors associated with heart attack occurrence, comparing results from <strong>univariate</strong> and <strong>multivariate</strong> logistic regression models. The odds ratios remain largely unchanged between the two models, indicating that <strong>there is minimal confounding among the included variables</strong>. This suggests that each factor—such as age group, smoking history, hypertension, diabetes, and family history—<strong>contributes independently to heart attack risk</strong> rather than being strongly influenced by other factors in the model. Notably, only the <strong>35-39 age group shows a significantly higher risk</strong>, while the other factors do not exhibit statistically significant associations. Further analyses, such as interaction tests, may be needed to explore potential combined effects between variables.</p>
<div class="cell">
<details class="code-fold">
<summary>Regression coefficients</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>final_mv_reg <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>() <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Odds Ratio of Heart Attack Occurrence (Multivariate Model)"</span>) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#e72222"</span>, <span class="st">"#8cb8c5"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exercise01_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This plot presents the <strong>odds ratio of heart attack occurrence</strong>, derived from a logistic regression model. In logistic regression, the coefficients represent the log-odds of an event occurring (in this case, a heart attack), and when exponentiated, they translate into odds ratios (ORs). An odds ratio above 1 indicates an increased risk, while an odds ratio below 1 suggests a reduced risk.</p>
<p>Each point represents the estimated odds ratio for a given variable, with the horizontal bars denoting the confidence intervals. If a confidence interval crosses the vertical dashed line at 1.00 (the null value), it suggests that the effect is not statistically significant.</p>
<ul>
<li>The age group 35-39 is the only category with a significantly higher risk of heart attack, as indicated by its confidence interval not crossing 1.</li>
<li>Other age groups show varying odds ratios, but their confidence intervals include 1, suggesting no strong evidence of increased risk.</li>
<li>Similarly, gender, urban/rural region, and medical history factors such as smoking, diabetes, hypertension, and family history exhibit varying effects, but none are statistically significant.</li>
</ul>
<p>Despite variations in odds ratios across age groups and medical history factors, the only statistically significant predictor of increased heart attack risk in this model is being in the 35-39 age group. Other factors may still contribute to risk, but this model does not find strong enough evidence to confirm their impact.</p>
<div class="cell">
<details class="code-fold">
<summary>Model Diagnostic</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(final_mv_reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exercise01_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<ol type="1">
<li><strong>Posterior Predictive Check</strong>: Observed and model-predicted data align well, indicating good overall fit.</li>
<li><strong>Binned Residuals</strong>: Several residuals fall outside error bounds, particularly between 10%–11% predicted probabilities, suggesting model miscalibration.</li>
<li><strong>Influential Observations</strong>: All the points are within the contour lines.</li>
<li><strong>Collinearity</strong>: All predictors have VIF values below 5, ruling out multicollinearity concerns.</li>
<li><strong>Uniformity of Residuals</strong>: Residuals follow the expected distribution, suggesting no significant pattern in errors.</li>
</ol>
<p>The model fits the data well but shows issues with calibration. For probability calibration, Platt scaling or isotonic regression could be considered. Model could be refined by adding interaction or polynomial terms.</p>
</section>
<section id="does-your-behavioural-and-lifestyle-factors-influence-your-medical-indicators" class="level2">
<h2 class="anchored" data-anchor-id="does-your-behavioural-and-lifestyle-factors-influence-your-medical-indicators">4.4 Does Your Behavioural and Lifestyle Factors Influence Your Medical Indicators?</h2>
<div class="cell">
<details class="code-fold">
<summary>Physical Activity VS Numerical Values</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggbetweenstats</span>(new_df2,</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> Physical_Activity,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> BMI,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">pairwise.comparisons =</span> <span class="cn">TRUE</span>, </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">title =</span> <span class="st">"Physical Activity VS BMI"</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggbetweenstats</span>(new_df2,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> Physical_Activity,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> Stress_Levels,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">pairwise.comparisons =</span> <span class="cn">TRUE</span>, </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">title =</span> <span class="st">"Physical Activity VS Stress Levels"</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggbetweenstats</span>(new_df2,</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> Physical_Activity,</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> Heart_Rate,</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">pairwise.comparisons =</span> <span class="cn">TRUE</span>, </span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">title =</span> <span class="st">"Physical Activity VS Heart Rate"</span>)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggbetweenstats</span>(new_df2,</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> Physical_Activity,</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> Cholesterol_Level,</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">pairwise.comparisons =</span> <span class="cn">TRUE</span>, </span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">title =</span> <span class="st">"Physical Activity VS Cholesterol"</span>)</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">ggbetweenstats</span>(new_df2,</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> Physical_Activity,</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> Systolic_BP,</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>                    <span class="at">pairwise.comparisons =</span> <span class="cn">TRUE</span>, </span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">title =</span> <span class="st">"Physical Activity VS Systolic BP"</span>)</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span> <span class="fu">ggbetweenstats</span>(new_df2,</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> Physical_Activity,</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> Diastolic_BP,</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>                    <span class="at">pairwise.comparisons =</span> <span class="cn">TRUE</span>, </span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>                    <span class="at">title =</span> <span class="st">"Physical Activity VS Diastolic BP"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Physical Activity VS Numerical Factors</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">+</span> p2)<span class="sc">/</span>(p3 <span class="sc">+</span> p4)<span class="sc">/</span>(p5 <span class="sc">+</span> p6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exercise01_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><strong>BMI</strong>: No significant difference across activity levels (p = 0.61), with mean BMIs around 25.</li>
<li><strong>Stress Levels</strong>: No significant effect of physical activity (p = 0.29), stress averages ~5.</li>
<li><strong>Heart Rate</strong>: Minimal difference between groups (p = 0.36), with means around 70 bpm.</li>
<li><strong>Cholesterol Levels</strong>: No significant variation by activity level (p = 0.64), averages ~200 mg/dL.</li>
<li><strong>Systolic Blood Pressure (BP)</strong>: No effect of activity on systolic BP (p = 0.91), means ~119 mmHg.</li>
<li><strong>Diastolic Blood Pressure (BP)</strong>: Slightly lower diastolic BP with higher activity (p = 0.03), but differences are small (79.96 to 79.21 mmHg).</li>
</ul>
<p>Physical activity has minimal impact on these health metrics, with only a minor difference in diastolic BP. Other metrics show no significant differences.</p>
<div class="cell">
<details class="code-fold">
<summary>Diet Quality VS Numerical Values</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>pd1 <span class="ot">&lt;-</span> <span class="fu">ggbetweenstats</span>(new_df2,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> Diet_Quality,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> BMI,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">pairwise.comparisons =</span> <span class="cn">TRUE</span>, </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">title =</span> <span class="st">"Diet Quality VS BMI"</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>pd2 <span class="ot">&lt;-</span> <span class="fu">ggbetweenstats</span>(new_df2,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> Diet_Quality,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> Stress_Levels,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">pairwise.comparisons =</span> <span class="cn">TRUE</span>, </span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">title =</span> <span class="st">"Diet Quality VS Stress Levels"</span>)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>pd3 <span class="ot">&lt;-</span> <span class="fu">ggbetweenstats</span>(new_df2,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> Diet_Quality,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> Heart_Rate,</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">pairwise.comparisons =</span> <span class="cn">TRUE</span>, </span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">title =</span> <span class="st">"Diet Quality VS Heart Rate"</span>)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>pd4 <span class="ot">&lt;-</span> <span class="fu">ggbetweenstats</span>(new_df2,</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> Diet_Quality,</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> Cholesterol_Level,</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">pairwise.comparisons =</span> <span class="cn">TRUE</span>, </span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">title =</span> <span class="st">"Diet Quality VS Cholesterol"</span>)</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>pd5 <span class="ot">&lt;-</span> <span class="fu">ggbetweenstats</span>(new_df2,</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> Diet_Quality,</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> Systolic_BP,</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>                    <span class="at">pairwise.comparisons =</span> <span class="cn">TRUE</span>, </span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">title =</span> <span class="st">"Diet Quality VS Systolic BP"</span>)</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>pd6 <span class="ot">&lt;-</span> <span class="fu">ggbetweenstats</span>(new_df2,</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> Diet_Quality,</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> Diastolic_BP,</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>                    <span class="at">pairwise.comparisons =</span> <span class="cn">TRUE</span>, </span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>                    <span class="at">title =</span> <span class="st">"Diet Quality VS Diastolic BP"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Diet Quality VS Numerical Factors</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>(pd1 <span class="sc">+</span> pd2)<span class="sc">/</span>(pd3 <span class="sc">+</span> pd4)<span class="sc">/</span>(pd5 <span class="sc">+</span> pd6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exercise01_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><strong>BMI</strong>: No significant difference across diet quality levels (p = 0.54), with mean BMIs around 25.</li>
<li><strong>Stress Levels</strong>: Minor differences, not significant (p = 0.50), with averages ~5.</li>
<li><strong>Heart Rate</strong>: No significant variation (p = 0.98), means ~70 bpm.</li>
<li><strong>Cholesterol Levels</strong>: No significant difference (p = 0.67), averages ~200 mg/dL.</li>
<li><strong>Systolic Blood Pressure (BP)</strong>: Slight variation but not significant (p = 0.16), means ~120 mmHg.</li>
<li><strong>Diastolic Blood Pressure (BP</strong>): No significant difference (p = 0.93), means ~80 mmHg.</li>
</ul>
<p>Diet quality has no significant impact on BMI, stress, heart rate, cholesterol, or blood pressure. All health metrics remain stable regardless of diet quality.</p>
<div class="cell">
<details class="code-fold">
<summary>Alcohol Consumption VS Numerical Values</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>pa1 <span class="ot">&lt;-</span> <span class="fu">ggbetweenstats</span>(new_df2,</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> Alcohol_Consumption,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> BMI,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">pairwise.comparisons =</span> <span class="cn">TRUE</span>, </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">title =</span> <span class="st">"Alcohol Consumpion VS BMI"</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>pa2 <span class="ot">&lt;-</span> <span class="fu">ggbetweenstats</span>(new_df2,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> Alcohol_Consumption,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> Stress_Levels,</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">pairwise.comparisons =</span> <span class="cn">TRUE</span>, </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">title =</span> <span class="st">"Alcohol Consumpion VS Stress Levels"</span>)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>pa3 <span class="ot">&lt;-</span> <span class="fu">ggbetweenstats</span>(new_df2,</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> Alcohol_Consumption,</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> Heart_Rate,</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">pairwise.comparisons =</span> <span class="cn">TRUE</span>, </span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">title =</span> <span class="st">"Alcohol Consumpion VS Heart Rate"</span>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>pa4 <span class="ot">&lt;-</span> <span class="fu">ggbetweenstats</span>(new_df2,</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> Alcohol_Consumption,</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> Cholesterol_Level,</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">pairwise.comparisons =</span> <span class="cn">TRUE</span>, </span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">title =</span> <span class="st">"Alcohol Consumpion VS Cholesterol"</span>)</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>pa5 <span class="ot">&lt;-</span> <span class="fu">ggbetweenstats</span>(new_df2,</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> Alcohol_Consumption,</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> Systolic_BP,</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>                    <span class="at">pairwise.comparisons =</span> <span class="cn">TRUE</span>, </span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">title =</span> <span class="st">"Alcohol Consumpion VS Systolic BP"</span>)</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>pa6 <span class="ot">&lt;-</span> <span class="fu">ggbetweenstats</span>(new_df2,</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> Alcohol_Consumption,</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> Diastolic_BP,</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>                    <span class="at">pairwise.comparisons =</span> <span class="cn">TRUE</span>, </span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>                    <span class="at">title =</span> <span class="st">"Alcohol Consumpion VS Diastolic BP"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Alcohol Consumption VS Numerical Factors</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>(pa1 <span class="sc">+</span> pa2)<span class="sc">/</span>(pa3 <span class="sc">+</span> pa4)<span class="sc">/</span>(pa5 <span class="sc">+</span> pa6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exercise01_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><strong>BMI</strong>: No significant difference across alcohol consumption levels (p = 0.78), with mean BMIs around 25.</li>
<li><strong>Stress Levels</strong>: Slight variation but not significant (p = 0.07), with stress averages around 5.</li>
<li><strong>Heart Rate</strong>: Minor differences but not significant (p = 0.09), with means around 70 bpm.</li>
<li><strong>Cholesterol Levels</strong>: No significant variation (p = 0.70), average levels ~200 mg/dL.</li>
<li><strong>Systolic Blood Pressure (BP)</strong>: No significant differences (p = 0.68), means ~120 mmHg.</li>
<li><strong>Diastolic Blood Pressure (BP</strong>): No significant differences (p = 0.59), means around 80 mmHg.</li>
</ul>
<p>Alcohol consumption shows no significant effect on BMI, stress, heart rate, cholesterol, or blood pressure. All metrics remain stable across consumption levels.</p>
</section>
<section id="how-do-uncontrollable-factors-interact-in-determining-your-heart-attack-risk-1" class="level2">
<h2 class="anchored" data-anchor-id="how-do-uncontrollable-factors-interact-in-determining-your-heart-attack-risk-1">4.5 How Do Uncontrollable Factors Interact in Determining Your Heart Attack Risk?</h2>
<div class="cell">
<details class="code-fold">
<summary>Univariate regression - Modifiable factors</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>univ_tab <span class="ot">&lt;-</span> <span class="fu">tbl_uvregression</span>(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    new_df2,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> glm,                           <span class="do">## define regression want to run (generalised linear model)</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> Heart_Attack_Occurrence,   </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">include =</span> <span class="fu">c</span>(</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Physical_Activity"</span>, <span class="st">"Diet_Quality"</span>,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Alcohol_Consumption"</span>, <span class="st">"BMI_Group"</span>,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Heart_Rate_Group"</span>, <span class="st">"Blood_Pressure"</span>,</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Cholesterol"</span>, <span class="st">"Stress"</span>),</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> binomial),  <span class="do">## define what type of glm want to run (logistic)</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">exponentiate =</span> <span class="cn">TRUE</span>                     <span class="do">## exponentiate to produce odds ratios (rather than log odds)</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Multivariate regression - Modifiable factors</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>explanatory_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Physical_Activity"</span>, <span class="st">"Diet_Quality"</span>,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Alcohol_Consumption"</span>, <span class="st">"BMI_Group"</span>,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Heart_Rate_Group"</span>, <span class="st">"Blood_Pressure"</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Cholesterol"</span>, <span class="st">"Stress"</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>mv_reg <span class="ot">&lt;-</span> explanatory_vars <span class="sc">%&gt;%</span>  <span class="do">## begin with vector of explanatory column names</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_c</span>(<span class="at">collapse =</span> <span class="st">"+"</span>) <span class="sc">%&gt;%</span>     <span class="do">## combine all names of the variables of interest separated by a plus</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_c</span>(<span class="st">"Heart_Attack_Occurrence ~ "</span>, .) <span class="sc">%&gt;%</span>    <span class="do">## combine the names of variables of interest with outcome in formula style</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(<span class="at">family =</span> <span class="st">"binomial"</span>,      <span class="do">## define type of glm as logistic,</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> new_df2)          <span class="do">## define your dataset</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>final_mv_reg <span class="ot">&lt;-</span> mv_reg <span class="sc">%&gt;%</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step</span>(<span class="at">direction =</span> <span class="st">"forward"</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>mv_tab <span class="ot">&lt;-</span> <span class="fu">tbl_regression</span>(final_mv_reg, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Merge regression results - Modifiable factors</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_merge</span>(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">tbls =</span> <span class="fu">list</span>(univ_tab, mv_tab),                          <span class="co"># combine</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">tab_spanner =</span> <span class="fu">c</span>(<span class="st">"**Univariate**"</span>, <span class="st">"**Multivariate**"</span>)) <span class="co"># set header names</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="ibveqarhgm" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ibveqarhgm table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ibveqarhgm thead, #ibveqarhgm tbody, #ibveqarhgm tfoot, #ibveqarhgm tr, #ibveqarhgm td, #ibveqarhgm th {
  border-style: none;
}

#ibveqarhgm p {
  margin: 0;
  padding: 0;
}

#ibveqarhgm .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ibveqarhgm .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ibveqarhgm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ibveqarhgm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ibveqarhgm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ibveqarhgm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ibveqarhgm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ibveqarhgm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ibveqarhgm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ibveqarhgm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ibveqarhgm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ibveqarhgm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ibveqarhgm .gt_spanner_row {
  border-bottom-style: hidden;
}

#ibveqarhgm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ibveqarhgm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ibveqarhgm .gt_from_md > :first-child {
  margin-top: 0;
}

#ibveqarhgm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ibveqarhgm .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ibveqarhgm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ibveqarhgm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ibveqarhgm .gt_row_group_first td {
  border-top-width: 2px;
}

#ibveqarhgm .gt_row_group_first th {
  border-top-width: 2px;
}

#ibveqarhgm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ibveqarhgm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ibveqarhgm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ibveqarhgm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ibveqarhgm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ibveqarhgm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ibveqarhgm .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ibveqarhgm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ibveqarhgm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ibveqarhgm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ibveqarhgm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ibveqarhgm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ibveqarhgm .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ibveqarhgm .gt_left {
  text-align: left;
}

#ibveqarhgm .gt_center {
  text-align: center;
}

#ibveqarhgm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ibveqarhgm .gt_font_normal {
  font-weight: normal;
}

#ibveqarhgm .gt_font_bold {
  font-weight: bold;
}

#ibveqarhgm .gt_font_italic {
  font-style: italic;
}

#ibveqarhgm .gt_super {
  font-size: 65%;
}

#ibveqarhgm .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ibveqarhgm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ibveqarhgm .gt_indent_1 {
  text-indent: 5px;
}

#ibveqarhgm .gt_indent_2 {
  text-indent: 10px;
}

#ibveqarhgm .gt_indent_3 {
  text-indent: 15px;
}

#ibveqarhgm .gt_indent_4 {
  text-indent: 20px;
}

#ibveqarhgm .gt_indent_5 {
  text-indent: 25px;
}

#ibveqarhgm .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ibveqarhgm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="gt_col_headings gt_spanner_row header">
<th rowspan="2" id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th colspan="4" id="**Univariate**" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
<strong>Univariate</strong>
</div></th>
<th colspan="3" id="**Multivariate**" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
<strong>Multivariate</strong>
</div></th>
</tr>
<tr class="gt_col_headings even">
<th id="stat_n_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>N</strong></th>
<th id="estimate_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>OR</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="conf.low_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="p.value_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
<th id="estimate_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>OR</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="conf.low_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="p.value_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">Physical_Activity</td>
<td class="gt_row gt_center" headers="stat_n_1">30,000</td>
<td class="gt_row gt_center" headers="estimate_1"><br>
</td>
<td class="gt_row gt_center" headers="conf.low_1"><br>
</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2"><br>
</td>
<td class="gt_row gt_center" headers="conf.low_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Low</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">—</td>
<td class="gt_row gt_center" headers="conf.low_1">—</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2">—</td>
<td class="gt_row gt_center" headers="conf.low_2">—</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Moderate</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">1.09</td>
<td class="gt_row gt_center" headers="conf.low_1">0.99, 1.20</td>
<td class="gt_row gt_center" headers="p.value_1">0.066</td>
<td class="gt_row gt_center" headers="estimate_2">1.08</td>
<td class="gt_row gt_center" headers="conf.low_2">0.99, 1.19</td>
<td class="gt_row gt_center" headers="p.value_2">0.10</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;High</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">1.05</td>
<td class="gt_row gt_center" headers="conf.low_1">0.95, 1.16</td>
<td class="gt_row gt_center" headers="p.value_1">0.3</td>
<td class="gt_row gt_center" headers="estimate_2">1.06</td>
<td class="gt_row gt_center" headers="conf.low_2">0.96, 1.18</td>
<td class="gt_row gt_center" headers="p.value_2">0.2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Diet_Quality</td>
<td class="gt_row gt_center" headers="stat_n_1">30,000</td>
<td class="gt_row gt_center" headers="estimate_1"><br>
</td>
<td class="gt_row gt_center" headers="conf.low_1"><br>
</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2"><br>
</td>
<td class="gt_row gt_center" headers="conf.low_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Poor</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">—</td>
<td class="gt_row gt_center" headers="conf.low_1">—</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2">—</td>
<td class="gt_row gt_center" headers="conf.low_2">—</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Average</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">1.04</td>
<td class="gt_row gt_center" headers="conf.low_1">0.93, 1.15</td>
<td class="gt_row gt_center" headers="p.value_1">0.5</td>
<td class="gt_row gt_center" headers="estimate_2">1.04</td>
<td class="gt_row gt_center" headers="conf.low_2">0.94, 1.16</td>
<td class="gt_row gt_center" headers="p.value_2">0.5</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Good</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">1.06</td>
<td class="gt_row gt_center" headers="conf.low_1">0.96, 1.18</td>
<td class="gt_row gt_center" headers="p.value_1">0.2</td>
<td class="gt_row gt_center" headers="estimate_2">1.07</td>
<td class="gt_row gt_center" headers="conf.low_2">0.96, 1.19</td>
<td class="gt_row gt_center" headers="p.value_2">0.2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Alcohol_Consumption</td>
<td class="gt_row gt_center" headers="stat_n_1">30,000</td>
<td class="gt_row gt_center" headers="estimate_1"><br>
</td>
<td class="gt_row gt_center" headers="conf.low_1"><br>
</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2"><br>
</td>
<td class="gt_row gt_center" headers="conf.low_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;None</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">—</td>
<td class="gt_row gt_center" headers="conf.low_1">—</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2">—</td>
<td class="gt_row gt_center" headers="conf.low_2">—</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Low</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">0.98</td>
<td class="gt_row gt_center" headers="conf.low_1">0.85, 1.12</td>
<td class="gt_row gt_center" headers="p.value_1">0.7</td>
<td class="gt_row gt_center" headers="estimate_2">0.97</td>
<td class="gt_row gt_center" headers="conf.low_2">0.84, 1.11</td>
<td class="gt_row gt_center" headers="p.value_2">0.6</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Moderate</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">0.91</td>
<td class="gt_row gt_center" headers="conf.low_1">0.80, 1.04</td>
<td class="gt_row gt_center" headers="p.value_1">0.2</td>
<td class="gt_row gt_center" headers="estimate_2">0.91</td>
<td class="gt_row gt_center" headers="conf.low_2">0.79, 1.04</td>
<td class="gt_row gt_center" headers="p.value_2">0.2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;High</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">0.97</td>
<td class="gt_row gt_center" headers="conf.low_1">0.84, 1.12</td>
<td class="gt_row gt_center" headers="p.value_1">0.6</td>
<td class="gt_row gt_center" headers="estimate_2">0.95</td>
<td class="gt_row gt_center" headers="conf.low_2">0.82, 1.11</td>
<td class="gt_row gt_center" headers="p.value_2">0.5</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">BMI_Group</td>
<td class="gt_row gt_center" headers="stat_n_1">30,000</td>
<td class="gt_row gt_center" headers="estimate_1"><br>
</td>
<td class="gt_row gt_center" headers="conf.low_1"><br>
</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2"><br>
</td>
<td class="gt_row gt_center" headers="conf.low_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Underweight (&lt;18.5)</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">—</td>
<td class="gt_row gt_center" headers="conf.low_1">—</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2">—</td>
<td class="gt_row gt_center" headers="conf.low_2">—</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Normal (18.5 to &lt;25)</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">1.17</td>
<td class="gt_row gt_center" headers="conf.low_1">1.02, 1.35</td>
<td class="gt_row gt_center" headers="p.value_1">0.028</td>
<td class="gt_row gt_center" headers="estimate_2">1.18</td>
<td class="gt_row gt_center" headers="conf.low_2">1.03, 1.37</td>
<td class="gt_row gt_center" headers="p.value_2">0.023</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Pre-Obese (25 to 30)</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">1.12</td>
<td class="gt_row gt_center" headers="conf.low_1">0.97, 1.30</td>
<td class="gt_row gt_center" headers="p.value_1">0.12</td>
<td class="gt_row gt_center" headers="estimate_2">1.14</td>
<td class="gt_row gt_center" headers="conf.low_2">0.98, 1.32</td>
<td class="gt_row gt_center" headers="p.value_2">0.084</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Obese (≥30)</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">0.99</td>
<td class="gt_row gt_center" headers="conf.low_1">0.84, 1.16</td>
<td class="gt_row gt_center" headers="p.value_1">0.9</td>
<td class="gt_row gt_center" headers="estimate_2">0.99</td>
<td class="gt_row gt_center" headers="conf.low_2">0.84, 1.17</td>
<td class="gt_row gt_center" headers="p.value_2">&gt;0.9</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Heart_Rate_Group</td>
<td class="gt_row gt_center" headers="stat_n_1">30,000</td>
<td class="gt_row gt_center" headers="estimate_1"><br>
</td>
<td class="gt_row gt_center" headers="conf.low_1"><br>
</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2"><br>
</td>
<td class="gt_row gt_center" headers="conf.low_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;&lt;40</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">—</td>
<td class="gt_row gt_center" headers="conf.low_1">—</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2">—</td>
<td class="gt_row gt_center" headers="conf.low_2">—</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;40-&lt;50</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">0.84</td>
<td class="gt_row gt_center" headers="conf.low_1">0.35, 2.51</td>
<td class="gt_row gt_center" headers="p.value_1">0.7</td>
<td class="gt_row gt_center" headers="estimate_2">0.78</td>
<td class="gt_row gt_center" headers="conf.low_2">0.32, 2.33</td>
<td class="gt_row gt_center" headers="p.value_2">0.6</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;50-&lt;60</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">0.98</td>
<td class="gt_row gt_center" headers="conf.low_1">0.42, 2.84</td>
<td class="gt_row gt_center" headers="p.value_1">&gt;0.9</td>
<td class="gt_row gt_center" headers="estimate_2">0.94</td>
<td class="gt_row gt_center" headers="conf.low_2">0.41, 2.73</td>
<td class="gt_row gt_center" headers="p.value_2">0.9</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;60-&lt;70</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">0.92</td>
<td class="gt_row gt_center" headers="conf.low_1">0.40, 2.65</td>
<td class="gt_row gt_center" headers="p.value_1">0.9</td>
<td class="gt_row gt_center" headers="estimate_2">0.87</td>
<td class="gt_row gt_center" headers="conf.low_2">0.38, 2.52</td>
<td class="gt_row gt_center" headers="p.value_2">0.8</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;70-&lt;80</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">1.00</td>
<td class="gt_row gt_center" headers="conf.low_1">0.44, 2.90</td>
<td class="gt_row gt_center" headers="p.value_1">&gt;0.9</td>
<td class="gt_row gt_center" headers="estimate_2">0.94</td>
<td class="gt_row gt_center" headers="conf.low_2">0.41, 2.74</td>
<td class="gt_row gt_center" headers="p.value_2">&gt;0.9</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;80-&lt;90</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">0.98</td>
<td class="gt_row gt_center" headers="conf.low_1">0.42, 2.84</td>
<td class="gt_row gt_center" headers="p.value_1">&gt;0.9</td>
<td class="gt_row gt_center" headers="estimate_2">0.95</td>
<td class="gt_row gt_center" headers="conf.low_2">0.41, 2.75</td>
<td class="gt_row gt_center" headers="p.value_2">&gt;0.9</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;90-&lt;100</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">1.06</td>
<td class="gt_row gt_center" headers="conf.low_1">0.45, 3.15</td>
<td class="gt_row gt_center" headers="p.value_1">&gt;0.9</td>
<td class="gt_row gt_center" headers="estimate_2">1.02</td>
<td class="gt_row gt_center" headers="conf.low_2">0.43, 3.04</td>
<td class="gt_row gt_center" headers="p.value_2">&gt;0.9</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;100-&lt;110</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">1.39</td>
<td class="gt_row gt_center" headers="conf.low_1">0.39, 5.17</td>
<td class="gt_row gt_center" headers="p.value_1">0.6</td>
<td class="gt_row gt_center" headers="estimate_2">1.39</td>
<td class="gt_row gt_center" headers="conf.low_2">0.39, 5.18</td>
<td class="gt_row gt_center" headers="p.value_2">0.6</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Blood_Pressure</td>
<td class="gt_row gt_center" headers="stat_n_1">28,828</td>
<td class="gt_row gt_center" headers="estimate_1"><br>
</td>
<td class="gt_row gt_center" headers="conf.low_1"><br>
</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2"><br>
</td>
<td class="gt_row gt_center" headers="conf.low_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Normal</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">—</td>
<td class="gt_row gt_center" headers="conf.low_1">—</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2">—</td>
<td class="gt_row gt_center" headers="conf.low_2">—</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;High-Normal</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">0.97</td>
<td class="gt_row gt_center" headers="conf.low_1">0.84, 1.11</td>
<td class="gt_row gt_center" headers="p.value_1">0.6</td>
<td class="gt_row gt_center" headers="estimate_2">0.97</td>
<td class="gt_row gt_center" headers="conf.low_2">0.84, 1.11</td>
<td class="gt_row gt_center" headers="p.value_2">0.6</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Elevated</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">0.98</td>
<td class="gt_row gt_center" headers="conf.low_1">0.89, 1.09</td>
<td class="gt_row gt_center" headers="p.value_1">0.8</td>
<td class="gt_row gt_center" headers="estimate_2">0.98</td>
<td class="gt_row gt_center" headers="conf.low_2">0.89, 1.09</td>
<td class="gt_row gt_center" headers="p.value_2">0.8</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Hypertension Grade I</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">1.02</td>
<td class="gt_row gt_center" headers="conf.low_1">0.90, 1.16</td>
<td class="gt_row gt_center" headers="p.value_1">0.8</td>
<td class="gt_row gt_center" headers="estimate_2">1.02</td>
<td class="gt_row gt_center" headers="conf.low_2">0.90, 1.16</td>
<td class="gt_row gt_center" headers="p.value_2">0.8</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Hypertension Grade II</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">1.04</td>
<td class="gt_row gt_center" headers="conf.low_1">0.79, 1.35</td>
<td class="gt_row gt_center" headers="p.value_1">0.8</td>
<td class="gt_row gt_center" headers="estimate_2">1.04</td>
<td class="gt_row gt_center" headers="conf.low_2">0.79, 1.35</td>
<td class="gt_row gt_center" headers="p.value_2">0.8</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Hypertension (Isolated) Systolic</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">0.97</td>
<td class="gt_row gt_center" headers="conf.low_1">0.83, 1.13</td>
<td class="gt_row gt_center" headers="p.value_1">0.7</td>
<td class="gt_row gt_center" headers="estimate_2">0.97</td>
<td class="gt_row gt_center" headers="conf.low_2">0.83, 1.13</td>
<td class="gt_row gt_center" headers="p.value_2">0.7</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Hypertension Grade III</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">0.88</td>
<td class="gt_row gt_center" headers="conf.low_1">0.26, 2.19</td>
<td class="gt_row gt_center" headers="p.value_1">0.8</td>
<td class="gt_row gt_center" headers="estimate_2">0.89</td>
<td class="gt_row gt_center" headers="conf.low_2">0.27, 2.22</td>
<td class="gt_row gt_center" headers="p.value_2">0.8</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Cholesterol</td>
<td class="gt_row gt_center" headers="stat_n_1">30,000</td>
<td class="gt_row gt_center" headers="estimate_1"><br>
</td>
<td class="gt_row gt_center" headers="conf.low_1"><br>
</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2"><br>
</td>
<td class="gt_row gt_center" headers="conf.low_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Low (&lt;120)</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">—</td>
<td class="gt_row gt_center" headers="conf.low_1">—</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2">—</td>
<td class="gt_row gt_center" headers="conf.low_2">—</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Normal (120 to &lt;219)</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">0.91</td>
<td class="gt_row gt_center" headers="conf.low_1">0.52, 1.74</td>
<td class="gt_row gt_center" headers="p.value_1">0.8</td>
<td class="gt_row gt_center" headers="estimate_2">1.02</td>
<td class="gt_row gt_center" headers="conf.low_2">0.56, 2.10</td>
<td class="gt_row gt_center" headers="p.value_2">&gt;0.9</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;High (≥219)</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">0.93</td>
<td class="gt_row gt_center" headers="conf.low_1">0.53, 1.79</td>
<td class="gt_row gt_center" headers="p.value_1">0.8</td>
<td class="gt_row gt_center" headers="estimate_2">1.05</td>
<td class="gt_row gt_center" headers="conf.low_2">0.58, 2.17</td>
<td class="gt_row gt_center" headers="p.value_2">0.9</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Stress</td>
<td class="gt_row gt_center" headers="stat_n_1">30,000</td>
<td class="gt_row gt_center" headers="estimate_1"><br>
</td>
<td class="gt_row gt_center" headers="conf.low_1"><br>
</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2"><br>
</td>
<td class="gt_row gt_center" headers="conf.low_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Very Low (0-2)</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">—</td>
<td class="gt_row gt_center" headers="conf.low_1">—</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2">—</td>
<td class="gt_row gt_center" headers="conf.low_2">—</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Low (2-4)</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">0.87</td>
<td class="gt_row gt_center" headers="conf.low_1">0.74, 1.02</td>
<td class="gt_row gt_center" headers="p.value_1">0.090</td>
<td class="gt_row gt_center" headers="estimate_2">0.89</td>
<td class="gt_row gt_center" headers="conf.low_2">0.75, 1.05</td>
<td class="gt_row gt_center" headers="p.value_2">0.2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Moderate (4-6)</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">0.87</td>
<td class="gt_row gt_center" headers="conf.low_1">0.75, 1.02</td>
<td class="gt_row gt_center" headers="p.value_1">0.081</td>
<td class="gt_row gt_center" headers="estimate_2">0.88</td>
<td class="gt_row gt_center" headers="conf.low_2">0.76, 1.04</td>
<td class="gt_row gt_center" headers="p.value_2">0.12</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;High (6-8)</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">0.81</td>
<td class="gt_row gt_center" headers="conf.low_1">0.69, 0.95</td>
<td class="gt_row gt_center" headers="p.value_1">0.011</td>
<td class="gt_row gt_center" headers="estimate_2">0.82</td>
<td class="gt_row gt_center" headers="conf.low_2">0.70, 0.98</td>
<td class="gt_row gt_center" headers="p.value_2">0.023</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Very High (8-10)</td>
<td class="gt_row gt_center" headers="stat_n_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_1">0.85</td>
<td class="gt_row gt_center" headers="conf.low_1">0.69, 1.04</td>
<td class="gt_row gt_center" headers="p.value_1">0.12</td>
<td class="gt_row gt_center" headers="estimate_2">0.87</td>
<td class="gt_row gt_center" headers="conf.low_2">0.71, 1.07</td>
<td class="gt_row gt_center" headers="p.value_2">0.2</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="8" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> OR = Odds Ratio, CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Regression coefficients</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>final_mv_reg <span class="sc">%&gt;%</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>() <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Odds Ratio of Heart Attack Occurrence (Multivariate Model)"</span>) <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#e72222"</span>, <span class="st">"#8cb8c5"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exercise01_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>The multivariate model reveals two unexpected results. First, the Normal BMI group (18.5 to &lt;25) is associated with a higher risk of heart attack, which may indicate an issue with the reference group—possibly using “underweight” instead of “overweight” as the baseline. Additionally, reverse causality could be at play, where chronic illnesses lower BMI but increase heart attack risk.</p>
<p>Second, high stress appears to lower heart attack risk, which is counter-intuitive. This may stem from survivourship bias, where individuals with heart conditions experience lifestyle adjustments that reduce stress levels. Additionally, measurement error from self-reported stress levels or unadjusted confounders, such as protective behaviors (e.g., exercise in high-stress careers), could influence this result.</p>
<p>To address these issues, we might want to check the model’s reference groups, adjust for comorbidities, and include interaction terms (e.g., stress × age).</p>
<div class="cell">
<details class="code-fold">
<summary>Model Diagnostic</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(final_mv_reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exercise01_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">4.6 Conclusion</h2>
<p>The analysis aimed to explore heart attack risk across demographics and identified that individuals aged <strong>35–39</strong> have a higher odds ratio. However, when evaluating lifestyle factors, the results were inconsistent. There were <strong>significant discrepancies between physical and medical indicators</strong>, and the <strong>controllable factors model produced counter-intuitive results</strong>, such as high stress showing a protective effect. These issues make it difficult to derive clear recommendations for lifestyle adjustments.</p>
<p>To address these concerns, it is essential to <strong>refine the model</strong> by reviewing reference groups to ensure appropriate baselines, such as using “normal BMI” and “low stress” as references. Additionally, including <strong>interaction terms</strong> (e.g., <em>age × physical activity</em>, <em>stress × BMI</em>) and adjusting for potential confounders, such as smoking and family history, can improve accuracy. A <strong>stratified analysis by age</strong> should also be performed, focusing on the 35–39 cohort to detect age-specific patterns.</p>
</section>
<section id="references-2" class="level2">
<h2 class="anchored" data-anchor-id="references-2">4.7 References</h2>
<ol type="1">
<li>https://epirhandbook.com/en/</li>
<li>https://r4va.netlify.app/</li>
<li>https://krassowski.github.io/complex-upset/articles/Examples_R.html</li>
<li>https://clarewest.github.io/blog/post/2020-03-26-upsetr-beyond-the-venn-diagram/</li>
<li>https://www.color-hex.com/color-palette/49506</li>
</ol>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/veeviann-isss608\.netlify\.app");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>